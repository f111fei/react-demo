<meta charset="utf-8"/> <textarea name="txt" id="m-sntf-module"> <ol class="m-msglist s-layscroll"><ol> </textarea> <textarea name="ntp" id="m-sntf-item"> <li> <a data-action="redirect" href="javascript:void(0);" class="u-face u-face-6"><div class="wrap"><img class="j-flag"></div></a> <div class="msgcnt j-flag"> <div class="who"> <a data-action="redirect" href="javascript:void(0);" class="j-flag name s-fc2"></a> <sup data-action="redirect" class="j-flag f-dn"></sup> <span class="j-flag type s-fc3"></span> <span class="time"> <time class="j-flag u-time s-fc4"></time> </span> </div> <div class="msgsay f-brk"> <span class="j-flag s-fc1"></span> </div> </div> </li> </textarea> <textarea name="js">(function(){var byz=NEJ.P,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bj=byz("nm.x"),bxI=byz("nm.i"),bR=byz("nm.l"),bp=byz("nm.d"),byx,byD;bxI.VE=NEJ.C();byx=bxI.VE.bS(bxI.jg);byx.dH=function(){this.dI()};byx.eo=function(){this.Yl="m-sntf-item"};byx.byL=function(){this.byO();var bg=byA.bV(this.bA,"j-flag");this.xw=bg.shift();this.Ov=bg.shift();this.ow=bg.shift();this.bzy=bg.shift();this.yE=bg.shift();this.sG=bg.shift();this.lC=bg.shift();bi.bM(this.bA,"click",this.ei.byB(this))};byx.gP=function(bh){if(!bh.notice){byA.bK(this.bA,"f-dn");return}byA.bJ(this.bA,"f-dn");bh.notice=bj.mE(bh.notice);this.xw.src=bh.notice.user.avatarUrl+"?param=32y32&quality=100";this.ddA&&byA.lG(this.ddA);this.ddA=byA.xQ(ctl.commonJST.cFB("com-user-type-2",bh.notice.user,"flag"));this.ddA&&this.xw.parentNode.parentNode.appendChild(this.ddA);this.sG.innerText=bj.rP(bh.time,true);this.ow.innerHTML=bj.fg(bh.notice.user.nickname);byA.bJ(this.Ov,"f-cd");switch(bh.notice.type){case 1:this.yE.innerText="赞了你的动态";if(bm.eA(bh.notice.track.json))bh.notice.track.json=JSON.parse(bh.notice.track.json);var byX="",cmt=bh.notice.track.json;switch(bh.notice.track.type){case 12:byX="我创建了歌单";byX+="「"+cmt.playlist.name+"」";byA.bK(this.Ov,"f-cd");break;case 13:byX="我分享了歌单";byX+="「"+cmt.playlist.name+"」";break;case 14:byX="我收藏了歌单";byX+="「"+cmt.playlist.name+"」";byA.bK(this.Ov,"f-cd");break;case 16:byX="我创建了节目";byX+="「"+cmt.program.name+"」";break;case 17:byX="我分享了节目";byX+="「"+cmt.program.name+"」";break;case 18:case 30:if(bh.notice.track.type==30){cmt.song=bj.cnh(cmt.song)}byX="我分享了单曲";var uE=bj.csw(cmt.song);byX+="「"+bj.fg(cmt.song.name)+(uE?' (<span class="s-fc4">'+bj.fg(uE)+"</span>)":"")+"」";break;case 19:byX="我分享了专辑";byX+="「"+cmt.album.name+"」";break;case 20:case 36:byX="我分享了歌手";byX=byX+"「"+cmt.resource.name+"」";break;case 21:byX="我分享了MV";byX+="「"+cmt.mv.name+"」";break;case 22:byX=bj.lO(cmt.msg,{parseAct:true})||"转发音乐";break;case 23:byX="我收藏了节目";byX+="「"+cmt.program.name+"」";byA.bK(this.Ov,"f-cd");break;case 24:byX="我分享了专栏文章";byX+="「"+cmt.topic.title+"」";break;case 27:byX="我订阅了电台";byX+="「"+cmt.djRadio.name+"」";byA.bK(this.Ov,"f-cd");break;case 28:byX="我分享了电台";byX+="「"+cmt.djRadio.name+"」";break;case 29:byX="我创建了电台";byX+="「"+cmt.djRadio.name+"」";byA.bK(this.Ov,"f-cd");break;case 31:byX="我分享了评论";byX=byX+"「"+cmt.resource.content+"」";break;case 35:byX="我的动态："+bj.lO(cmt.msg,{parseAct:true})+(bh.notice.track.pics&&bh.notice.track.pics.length?"[图片]":"");break;default:this.yE.innerText="";byX='<p class="s-fc3">你当前的应用版本无法显示这条信息</p>';byA.bK(this.Ov,"f-cd");break}this.lC.innerHTML=byX;break;case 2:this.yE.innerText="收藏了你的歌单";this.lC.innerText="「"+bh.notice.playlist.name+"」";break;case 3:this.yE.innerText="分享了你的歌单";this.lC.innerText="「"+bh.notice.playlist.name+"」";break;case 4:this.yE.innerText="分享了你的节目";this.lC.innerText="「"+bh.notice.program.name+"」";break;case 5:this.yE.innerText="收藏了你的节目";this.lC.innerText="「"+bh.notice.program.name+"」";break;case 6:this.yE.innerText="赞了你的评论";this.lC.innerHTML=bj.lO((bh.notice.comment||cJO).content||"",{parseAct:true});break;case 7:this.yE.innerText="赞了你的节目";this.lC.innerText="「"+bh.notice.program.name+"」";break;case 8:this.yE.innerText="订阅了你的电台";this.lC.innerText="「"+bh.notice.djRadio.name+"」";break;case 9:this.yE.innerText="赞了你的专栏文章";this.lC.innerText="「"+bh.notice.topic.title+"」";break;default:this.yE.innerText="";this.lC.innerHTML='<p class="s-fc3">你当前的应用版本无法显示这条信息</p>';byA.bK(this.Ov,"f-cd");break}if([4,5,7].indexOf(bh.notice.type)>=0){byA.bT(this.bA,"resAction","play");byA.bT(this.bA,"resId",bh.notice.program.id);byA.bT(this.bA,"resType",3);byA.bT(this.bA,"resFrom",-13)}else{byA.bT(this.bA,"resAction","");byA.bT(this.bA,"resId","");byA.bT(this.bA,"resType","");byA.bT(this.bA,"resFrom","")}};byx.ei=function(byy){if(this.qk(byy))return;var bk=bi.cR(byy,"d:action"),cX=byA.bT(bk,"action");if(cX=="redirect"){dispatcher.dr("/m/personal/?uid="+this.bW.notice.user.userId);this.bzj()}else if(cX=="activity"){var oS=byA.bT(bk,"title");oS=/^#(.+?)#$/.exec(oS)[1];this.bF("onactivity",oS);this.bzj()}else{if(byA.ey(this.Ov,"f-cd"))return;switch(this.bW.notice.type){case 1:var lD=this.bW.notice.track.type;if(lD==12||lD==14||lD==23||lD==27||lD==29)return;dispatcher.dr("/m/friend/event/?id="+this.bW.notice.track.id+"&uid="+this.bW.notice.track.user.userId);bi.bQd(byy);break;case 2:case 3:dispatcher.dr("/m/playlist/?id="+this.bW.notice.playlist.id);bi.bQd(byy);break;case 8:dispatcher.dr("/m/djradio/?id="+this.bW.notice.djRadio.id);bi.bQd(byy);break;case 9:this.bF("ontopic",this.bW.notice.topic.id);bi.bQd(byy);break;case 6:var hs=(this.bW.notice.comment||cJO).threadId,bTj=(this.bW.notice.comment||cJO).commentId;if(!!hs){var bq=hs.substr(0,5),bo=(/_(\d+)$/.exec(hs)||cJO)[1];if(bq&&bo){switch(bq){case"R_AL_":dispatcher.dr("/m/album/comment/?id="+bo+"&rid="+hs+"&commentId="+bTj);break;case"A_DJ_":dispatcher.dr("/m/song?rid="+hs+"&commentId="+bTj);break;case"A_PL_":dispatcher.dr("/m/playlist/comment/?id="+bo+"&rid="+hs+"&commentId="+bTj);break;case"R_SO_":dispatcher.dr("/m/song?rid="+hs+"&commentId="+bTj);break;case"A_EV_":var bZ=bo;bo=(/_(\d+)_(\d+)$/.exec(hs)||cJO)[1];dispatcher.dr("/m/friend/event/?id="+bo+"&commentId="+bTj+"&uid="+bZ);break;case"R_MV_":dispatcher.dr("/m/song?rid="+hs+"&commentId="+bTj);break;case"A_TO_":dispatcher.dr("/m/song?rid="+hs+"&commentId="+bTj);break;default:logger.warn("threadId err",hs,"notify.js");break}}else{logger.warn("threadId err",hs,"notify.js")}}else{logger.error("can not find threadId in comment data",this.bW.notice.comment,"notify.js")}break;default:logger.warn("onAction notice type err",this.bW.notice,"notify.js");break}if(this.bW.notice.type!=9){this.bzj()}}};byx.qk=function(byy){if(byA.ey(byy.srcElement,"j-atlink")){if(location.href!=byy.srcElement.href)location.href=byy.srcElement.href;this.bzj();return true}return false};byx.bzj=function(){dispatcher.gM({to:"/?/frame/top/",from:"",data:"onclose",mode:0})}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),bi=byz("nej.v"),bU=byz("nej.ut"),bj=byz("nm.x"),bxI=byz("nm.i"),bp=byz("nm.d"),bY=byz("nm.m"),bC=byz("nm.m.s"),byx,byD;bC.bCD=NEJ.C();byx=bC.bCD.bS(bY.cW);byx.byG=function(){this.bCU="m-sntf";this.dg();this.bL={limit:20,parent:this.bA,sbody:this.bA,delta:30,item:{klass:bxI.VE,onactivity:this.dfb.byB(this),ontopic:this.cgf.byB(this)},cache:{klass:bp.bzn,clear:true,onlisterror:this.sZ.byP(this,this.bA)},onemptylist:this.bAe.byB(this,"暂无通知内容"),onafterlistload:this.bzK.byB(this),onbeforelistload:this.im.byB(this,"m-xwgt-white-list-loading"),onafterpullrefresh:this.og.byB(this),onbeforepullrefresh:this.im.byB(this,"m-xwgt-white-list-loading"),onbeforelistclear:this.bzb.byB(this)};this.bL.cache.onerror=this.ej.byP(this,true,this.bL.parent)};byx.dq=function(blZ){this.dC(blZ);if(bj.btm()){byA.eB(this.bA,"m-common-empty-list",{text:"暂无通知内容"});return}var cJN=this.bL.cache,bZ=localCache.cF("host.profile.userId");cJN.lkey="message_notify-"+bZ;if(!!this.cw)this.cw.bQ();this.cw=bU.jN.bG(this.bL);if(this.cQz)this.cQz.bQ();this.cQz=bp.cTb.bG({onactivitytitle:this.ddp.byB(this),onactivitytitleerror:this.ddo.byB(this)});if(this.dfe)this.dfe.bQ();this.dfe=bp.cVD.bG({onitemload:this.dft.byB(this),ontopicerror:this.dfv.byB(this)})};byx.hA=function(bn){if(!!bn&&bn.data=="onrefresh"){this.dq({})}};byx.dfb=function(oS){this.cQz.ddF(oS)};byx.ddp=function(cRq){if(cRq.act){location.href="#/m/friend/activity?id="+cRq.act.actId+"&r="+Math.random()}else{bj.ci({txt:"该话题暂未创建"})}};byx.ddo=function(){bj.ci({txt:"该话题暂未创建"})};byx.cgf=function(dgq){this.dfe.dfq(dgq)};byx.dft=function(byy){var bJB=this.dfe.cl(byy.id);if(bJB.number==0||bJB.status==-1){bj.ci({txt:"该资源已不存在"})}else{dispatcher.dr("/m/topic/?id="+byy.id)}};byx.dfv=function(){bj.ci({txt:"该资源已不存在"})};bj.cU("/?/message/notify/",bC.bCD)})()</textarea>
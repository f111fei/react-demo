<meta charset="utf-8" /> <textarea name="txt" id="m-share-module"> <div> <div class="j-flag"></div> <div class="lybt f-cb"> <div class="shareto j-flag"> <span class="s-fc3 f-fl">同时分享到：</span> <ul class="sns u-logo f-fl f-cb"> <li><span class="sina z-gray j-flag" title="新浪微博">新浪微博</span></li> <li><span class="rr z-gray j-flag f-dn" title="人人网">人人网</span></li> <li><span class="db z-gray j-flag" title="豆瓣">豆瓣</span></li> <li><span class="yx z-gray z-gray j-flag" title="易信">易信</span></li> </ul> </div> <button class="u-ibtn1 u-ibtnsz1 f-fr z-dis j-flag">分 享</button> </div> </div> </textarea> <textarea name="js">(function(){var byz=NEJ.P,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.n"),cmw=byz("nej.ui"),gD=byz("nm.w"),bj=byz("nm.x"),bR=byz("nm.l"),bp=byz("nm.d"),byx,byD;bj.cMP=NEJ.C();byx=bj.cMP.bS(cmw.hl);byx.eo=function(){this.Yl="m-xwgt-share-replier"};byx.byL=function(){this.byO();var ko=byA.bV(this.bA,"j-flag");this.Fj=ko.shift();this.cKe=ko.shift();this.Fk=ko.shift();this.ck=ko.shift();this.cJS=ko.shift();this.cKd=ko.shift();this.cKt=byA.gj(this.cKd)[0];this.cKf=byA.gj(this.cKd)[1];this.qF=ko.shift();this.crv=ko.shift();this.Nz=ko.shift();this.Ff=ko.shift();this.AI=ko.shift();this.ddi=ko.shift();this.cvK=ko.shift();this.oN=ko.shift();this.ND=ko.shift();this.hS=ko.shift();this.cMT=ko.shift();this.ddj=ko.shift();bR.bBA.boe(this.ck,{fixed:true,button:this.Nz,parent:this.Ff});this.byJ={onlistload:this.bhX.byB(this)};this.qG=[]};byx.cJ=function(blZ){this.cK(blZ);this.bA.reset();this.NV(blZ);this.bho(blZ);this.bgA(blZ);this.dge(blZ);this.bgl(blZ);this.cMU(blZ);this.bGt(blZ);this.cut=!!blZ.hideBtnBox;if(this.cut){byA.bK(this.crv,"f-dn")}else{byA.bJ(this.crv,"f-dn")}this.cJS.style.display="none";this.cKd.style.display="none";this.ck.placeholder=blZ.placeholder||"";if(this.iB&&this.iB.show)this.uK();this.iB={show:false};!!this.bH&&this.bH.bQ();this.bH=bp.du.bG(this.byJ);this.ck.style.height="";this.bfd=blZ.enableBlank||false;this.beJ=!!blZ.showAtDelete;this.bBE=false;if(!!blZ.btnNode&&this.oN!==blZ.btnNode){bi.kS(this.oN);this.bGt({hideSndBtn:true});this.oN=blZ.btnNode;bi.bM(this.oN,"click",this.Fr.byB(this))}this.rJ({btnText:blZ.btnText?blZ.btnText:"发送",btnClazz:"z-dis"});delete this.bzk;this.bTA=blZ.onelinewords;this.cGQ=blZ.msgKey||"";this.cHZ(blZ.text);if(!blZ.hideHash){this.cTa=bj.cZs.bG({editor:this.ck,suggest:this.ddj,copy:this.Fk,action:blZ.action||"share"})}this.dO([[this.AI,"click",this.bkT.byB(this)],[this.ddi,"click",this.ddk.byB(this)],[this.ck,"keydown",this.bkN.byB(this)],[this.ck,"keyup",this.bkl.byB(this)],[this.ck,"compositionend",this.bjG.byB(this)],[this.ck,"compositionstart",this.biX.byB(this)],[this.ck,"cut",this.biW.byB(this)],[this.ck,"click",this.biS.byB(this)],[this.ck,"input",this.NN.byB(this)],[this.ck,"focus",this.biQ.byB(this)],[this.ck,"textInput",this.PZ.byB(this)][this.ck.parentNode,"click",function(){this.ck.focus()}.byB(this)],[document.body,"click",this.biL.byB(this)],[this.hS,"click",this.biN.byB(this)],[gD.bOW,"mvfullscreencomment",function(){this.ck.focus()}.byB(this)]])};byx.cHU=function(SP){SP.list=[];SP.maxL=20};byx.cHZ=function(ds){if(this.cGQ){var SP=bj.cmN("commentReplierMessage",this.cHU);var bg=SP.list,bs=bm.eT(bg,function(bl){return bl&&bl.key==this.cGQ}.byB(this));if(bs>=0){var bh=bg[bs];this.bzk=bh.replyData;this.uv(bh.msg);bg.splice(bs,1)}}else{this.uv(ds||"")}};byx.cIa=function(){if(this.cGQ){var cv=this.ck.value;if(/^\s*$/.test(cv))return;var SP=bj.cmN("commentReplierMessage",this.cHU);var bg=SP.list;bg.push({key:this.cGQ,msg:cv,replyData:this.bzk});if(bg.length>SP.maxL)bg.length=SP.maxL}};byx.dH=function(){this.cIa();this.dI();if(this.cTa){this.cTa.bQ();this.cTa=null}this.bH.bQ();this.bH=null;if(this.bbT){this.bbT.bQ();this.bbT=null}bi.kS(this.cvK);bi.kS(this.oN)};byx.wE=function(){this.bH.eN("user_follow-"+localCache.cF("host.profile.userId"));this.bH.fE({key:"user_follow-"+localCache.cF("host.profile.userId"),data:{limit:1e4,offset:0,total:true,order:true,userId:localCache.cF("host.profile.userId")}})};byx.bhX=function(blZ){if(blZ.key=="user_follow-"+localCache.cF("host.profile.userId")){this.qG=[];var bg=this.bH.byI(blZ.key);for(var i=0,ii=bg.length;i<ii;i++){if(bg[i])this.qG.push({nick:bg[i].nickname,py:bg[i].py})}}};byx.bGt=function(blZ){this.bGu=blZ.hideSndBtn;if(this.bGu)byA.bK(this.oN,"f-dn");else byA.bJ(this.oN,"f-dn")};byx.bgl=function(blZ){this.bed=blZ.hideEmot;if(this.bed)byA.bK(this.Nz,"f-dn");else byA.bJ(this.Nz,"f-dn")};byx.bgA=function(blZ){this.Oh=blZ.hideAt||false;if(this.Oh)byA.bK(this.AI,"f-dn");else byA.bJ(this.AI,"f-dn")};byx.dge=function(blZ){this.dgf=blZ.hideHash||false;if(this.dgf)byA.bK(this.ddi,"f-dn");else byA.bJ(this.ddi,"f-dn")};byx.bho=function(blZ){this.PS=blZ.remain;if(!!this.PS)byA.bJ(this.qF,"f-dn");else byA.bK(this.qF,"f-dn");this.rW=blZ.maxLen||140;this.qF.innerText=this.rW;byA.bJ(this.qF,"z-over")};byx.cMU=function(blZ){this.cLY=blZ.uploadLimit;if(!this.cLY){byA.bK(this.cvK,"f-dn");if(!!this.bbT)this.bbT.bQ();delete this.bbT}else if(this.cLY==1){byA.bJ(this.cvK,"f-dn");if(!!this.bbT)this.bbT.bQ();this.bbT=gD.cMS.bG({parent:this.cMT,button:this.cvK})}else{byA.bJ(this.cvK,"f-dn");if(!!this.bbT)this.bbT.bQ();delete this.bbT;bi.kS(this.cvK);bi.bM(this.cvK,"click",function(){bj.ci({state:"failed",txt:APP_CONF.sharePermission.pubEventWithPictureForbiddenNotice})})}};byx.NV=function(blZ){if(!!blZ.btnText)this.oN.innerText=blZ.btnText;if(!!blZ.btnClazz)this.oN.className=blZ.btnClazz;if(!!blZ.editorClazz)this.Fj.className=blZ.editorClazz;else this.Fj.className="m-editor lyct"};byx.bkN=function(byy){var FE=byy.keyCode;switch(FE){case 8:case 46:this.Ol();break;case 13:case 108:if(this.iB.show){bi.bQd(byy);this.bdW()}break;case 38:case 40:if(this.iB.show){this.bdP(FE==38?-1:1);bi.bQd(byy)}else{bi.sA(byy)}break}};byx.bkl=function(byy){var FE=byy.keyCode;switch(FE){case 32:this.uK();this.NN();break;case 37:case 39:this.ky();break;case 38:case 40:this.ky();break;case 50:this.ky();break;default:this.ky();break}};byx.biX=function(byy){this.PZ()};byx.bjG=function(byy){this.bBE=byy.data===""?false:true;this.ky()};byx.biW=function(byy){this.Ol()};byx.PZ=function(byy){var eJ=this.ck.selectionStart,fs=this.ck.selectionEnd,dN=this.ck.value;if(eJ==fs)return;if(this.bBE){this.ky();this.bBE=false;return}this.Ol();eJ=this.ck.selectionStart;fs=this.ck.selectionEnd;this.ck.value=dN.substring(0,eJ)+dN.substr(fs);this.ck.selectionStart=this.ck.selectionEnd=eJ};byx.biS=function(byy){this.ky()};byx.biQ=function(byy){this.xj();byA.bJ(this.Fj,"m-editor-sm")};byx.ky=function(){var fs=this.ck.selectionStart,dN=this.ck.value||"",eJ=dN.lastIndexOf("@",fs-1);if(fs==0||dN.charAt(fs-1)==" "||dN.charAt(fs-1)==":"||eJ==-1){this.uK();return}var bzh=dN.substring(eJ+1,fs)||"";if(!bzh||/^[\u4e00-\u9fa5A-Za-z0-9-_]+$/.test(bzh)){this.PQ(bzh,eJ)}else{this.uK()}};byx.bkT=function(byy){this.ck.focus();var jm=this.ck.selectionStart,fs=this.ck.selectionEnd,dN=this.ck.value;if(!(dN.charAt(jm-1)=="@")){this.ck.value=dN.substring(0,jm)+"@"+dN.substr(fs);this.ck.selectionStart=jm+1;this.ck.selectionEnd=jm+1}this.PQ("",this.ck.selectionStart-1)};byx.ddk=function(){this.cTa.ddH()};byx.PQ=function(eD,eJ){this.xj();if(this.Oh)return;eD=(eD||"").toLowerCase();if(this.iB.show&&this.iB.query==eD&&this.iB.pos==eJ)return;var fs=this.ck.selectionStart,dN=this.ck.value,eJ=dN.lastIndexOf("@",fs-1),dT=bj.fg(dN.substring(0,eJ))+'<span style="display:inline-block;">@<div id="widget-at-postion"></div></span>';this.Fk.innerHTML=dT;if(this.ck.scrollHeight==this.ck.offsetHeight&&this.Fk.scrollHeight==this.Fk.offsetHeight){this.Fk.parentNode.parentNode.style.right="10px"}else if(this.ck.scrollHeight>this.ck.offsetHeight&&this.Fk.scrollHeight>this.Fk.offsetHeight){this.Fk.parentNode.parentNode.style.right="10px"}else if(this.Fk.scrollHeight>this.Fk.offsetHeight){this.Fk.parentNode.parentNode.style.right="2px"}else{this.Fk.parentNode.parentNode.style.right="10px"}var bk=document.getElementById("widget-at-postion"),Oq=this.hS.parentNode,bh=this.bcl(eD);byA.bK(Oq,"z-show");var cr=byA.lp(bk,this.Fj),dgt=byA.lp(bk),eI=dgt.x+Oq.offsetWidth-document.body.offsetWidth;cr.y-=this.ck.scrollTop;Oq.style.top=cr.y+"px";if(eI>10){Oq.style.left=cr.x-eI-10+"px"}else{Oq.style.left=cr.x+"px"}byA.lG(bk);if(bh.total)this.ND.innerText="选择最近@的人或直接输入";else this.ND.innerText="轻敲空格完成输入";if(!eD&&this.qG.length==0)this.ND.innerText="关注好友，分享音乐给Ta";this.hS.scrollTop=0;this.hS.innerHTML=bh.html;this.iB.show=true;this.iB.index=bh.index;this.iB.total=bh.total;this.iB.query=bh.query;this.iB.pos=eJ;if(this.cTa){this.cTa.cTc();this.cTa.dab(true)}};byx.uK=function(){if(!this.iB.show)return;byA.bJ(this.hS.parentNode,"z-show");this.hS.innerHTML="";this.iB.show=false;if(this.cTa){this.cTa.dab(false)}};byx.bdP=function(cr){var bk=this.hS.firstElementChild,bs=this.iB.index;if(!bk)return;while(bs){bk=bk.nextElementSibling;bs--}byA.bJ(bk,"z-sel");switch(cr){case-1:if(bk.previousElementSibling){bk=bk.previousElementSibling;bs=this.iB.index-1}else{bk=this.hS.lastElementChild;bs=this.iB.total-1}break;case 1:if(bk.nextElementSibling){bk=bk.nextElementSibling;bs=this.iB.index+1}else{bk=this.hS.firstElementChild;bs=0}break}byA.bK(bk,"z-sel");this.iB.index=bs;this.bbX(bk,bs)};byx.bbX=function(bk,bs){var PN=25,Ou=(PN+1)*bs,PM=Ou+PN;if(Ou<bk.parentNode.scrollTop){bk.parentNode.scrollTop=Ou}else{if(PM>bk.parentNode.scrollTop+bk.parentNode.clientHeight){bk.parentNode.scrollTop=PM-bk.parentNode.clientHeight}}};byx.biN=function(byy){var gx=byy.srcElement.textContent+" ";this.ck.focus();this.PL(gx)};byx.bdW=function(){var bk=this.hS.firstElementChild,bs=this.iB.index;if(!bk)return;while(bs){bk=bk.nextElementSibling;bs--}this.PL(bk.textContent+" ")};byx.PL=function(gx){var fs=this.ck.selectionStart,dN=this.ck.value,jm=dN.lastIndexOf("@",fs-1)+1;this.uv(dN.substring(0,jm)+gx+dN.substr(fs));jm+=gx.length;this.ck.selectionStart=jm;this.ck.selectionEnd=jm;this.uK();this.NN()};byx.bcl=function(eD){var Ox=this.bvq(eD);var dT="",gx;for(var cmw=0,jF=Ox.length;cmw<jF;cmw++){dT+="<li"+(cmw==0?' class="z-sel"':"")+">"+Ox[cmw]+"</li>"}return{html:dT,total:Ox.length,index:0,query:eD}};byx.bvq=function(eD){var bzc=10,bE=[];if(!eD){for(var i=0,ii=this.qG.length;i<ii;i++){if(i<bzc)bE.push(this.qG[i].nick);else break}}else{var t=eD.split("");var texp=".*"+t.join(".*")+".*";var dp=new RegExp(texp,"ig");for(var i=0,ii=this.qG.length;i<ii;i++){if(bzc){if(dp.test(window.pinyin(this.qG[i].nick))||dp.test(this.qG[i].nick)){bE.push(this.qG[i].nick);bzc--}}else{break}}}return bE};byx.Ol=function(){if(this.Oh&&!this.beJ)return;var eJ=this.ck.selectionStart,fs=this.ck.selectionEnd,dN=this.ck.value,dp=/^[\u4e00-\u9fa5A-Za-z0-9-_]+$/,bzi,iX,gx;if(eJ==fs){bzi=dN.lastIndexOf("@",eJ-1);if(bzi>-1){iX=this.FN(dN.indexOf(" ",bzi),dN.indexOf(":",bzi));if(iX>-1){if(bzi<=eJ-1&&iX>=eJ-1){gx=dN.substring(bzi,iX+1);if(/^@[\u4e00-\u9fa5A-Za-z0-9-_]+[ :]$/.test(gx)){this.bF("onatchange",gx);this.ck.setSelectionRange(bzi,iX+1)}}}}}else{var bzt=dN.lastIndexOf("@",eJ-1),bzc=this.FN(dN.indexOf(" ",fs),dN.indexOf(":",fs)),kN=false;if(bzt==-1)bzt=eJ;else{bzi=dN.indexOf("@",bzt+1);iX=this.FN(dN.indexOf(" ",bzt),dN.indexOf(":",bzt));if(iX>-1){if(iX<eJ||bzi>-1&&bzi<iX)bzt=eJ}else{kN=true}}if(kN)return;if(bzc==-1)bzc=fs-1;else{bzi=dN.lastIndexOf("@",bzc);iX=this.bth(dN.lastIndexOf(" ",bzc-1),dN.lastIndexOf(":",bzc-1));if(bzi>-1){if(bzi>=fs||iX>-1&&bzi<iX)bzc=fs-1}else{kN=true}}if(kN)return;var PG=bzt,PF=bzc;while(bzt<bzc){bzi=dN.indexOf("@",bzt);if(bzi>-1){if(bzi<bzc){iX=this.FN(dN.indexOf(" ",bzi),dN.indexOf(":",bzi));if(iX>-1){if(iX<=bzc){gx=dN.substring(bzi,iX+1);if(/^@[\u4e00-\u9fa5A-Za-z0-9-_]+[ :]$/.test(gx)){this.bF("onatchange",gx)}else{if(bzi<eJ)PG=eJ;if(iX>=fs)PF=fs-1}bzt=iX+1}else break}else break}else break}else break}this.ck.setSelectionRange(PG,PF+1)}};byx.FN=function(us,uq){if(us==-1)return uq;if(uq==-1)return us;return Math.min(us,uq)};byx.bth=function(us,uq){if(us==-1)return uq;if(uq==-1)return us;return Math.max(us,uq)};byx.bpQ=function(){var bsq=99999;if(!!this.PS){var AZ=this.rW;var jF=this.ck.value.length;if(!!this.bzk&&this.ck.value.indexOf(this.bzk.prefix)==0)AZ+=this.bzk.prefix.length;bsq=AZ-jF}return bsq};byx.xj=function(){if(!!this.PS){var AZ=this.rW,jP=this.ck.value||"";if(!!this.bzk&&this.ck.value.indexOf(this.bzk.prefix)==0){jP=this.ck.value.substr(this.bzk.prefix.length)}var jF=bj.rV(jP);if(jF>AZ){byA.bK(this.qF,"z-over")}else{byA.bJ(this.qF,"z-over")}this.qF.innerText=AZ-jF}};byx.bHD=function(){this.xj()};byx.NN=function(byy){this.xj();this.uo();setTimeout(function(){this.ky()}.byB(this),5)};byx.uo=function(){};var ul=function(OL,eJ){OL.focus();var jP=eJ===undefined?OL.value.length:eJ;OL.setSelectionRange(jP,jP)};byx.byv=function(cv){var FR=this.ck.value;this.ck.value+=cv;ul(this.ck);if(this.xj()){this.ck.value=FR;this.bF("onexceedmax",cv)}this.uo();this.ky()};byx.bnI=function(cv){var FR=this.ck.value;this.ck.value=cv+FR;ul(this.ck,0);if(this.xj()){this.ck.value=FR;ul(this.ck,0);this.bF("onexceedmax",cv)}this.uo();this.ky()};byx.bms=function(cv){var dN=this.ck.value,eJ=dN.indexOf(cv);if(eJ>-1){this.ck.value=dN.replace(cv,"");this.xj();this.ky()}ul(this.ck,0);this.uo();this.ky()};byx.bIl=function(){return this.ck.value};byx.uv=function(cv){this.ck.value=cv||"";this.xj();ul(this.ck);this.uo();this.ky()};byx.OQ=function(cv){this.ck.value=cv||"";this.xj();ul(this.ck,0);this.uo();this.ky()};byx.blx=function(oW){this.bzk=oW;this.ck.value=this.bzk.prefix;ul(this.ck);this.uo();this.ky()};byx.blh=function(byy){var bAY=false;if(this.bfd)return false;var bO=!!this.bzk&&this.ck.value.indexOf(this.bzk.prefix)==0?this.ck.value.substr(this.bzk.prefix.length):this.ck.value;if(bO.length==0||/^\s*$/.test(bO)){bAY=true}return bAY};byx.Fr=function(byy){if(bj.btm()){bj.bNt("comment-add");return}var dN="";if(navigator.offline){dN="网络不给力哦，请检查你的网络设置~"}else if(this.blh()){dN="写点东西吧，内容不能为空哦！"}else if(byA.ey(this.qF,"z-over")){dN="字数超过限制"}if(!!dN){bj.ci({txt:dN});return}var cv=this.ck.value;bi.bQd(byy);var bh={content:cv};if(this.cLY==1){bh.img=this.bbT.cNx()}if(!!this.bzk&&this.ck.value.indexOf(this.bzk.prefix)==0){this.bzk.data.content=bh.content.substr(this.bzk.prefix.length);var byH=this.bzk.data.user;var biZ=this.bzk.prefix;delete this.bzk.data.user;delete this.bzk.prefix;this.bzk.reply=true;this.bF("onreply",this.bzk);this.bzk.data.user=byH;this.bzk.prefix=biZ}else{this.bF("onreply",bh)}};byx.ED=function(){this.Fr()};byx.btp=function(){this.ck.value="";this.qF.innerText=this.rW;byA.bJ(this.qF,"z-over");delete this.bzk;this.uK();if(this.cTa)this.cTa.cTc();byA.bJ(this.Fj,"m-editor-sm");this.ck.style.height=""};byx.xk=function(blZ){if(!!blZ.btnText)this.oN.innerText=blZ.btnText;if(!!blZ.btnClazz)byA.bK(this.oN,blZ.btnClazz);bi.kS(this.oN,"click");if(!blZ.editorAbled){this.ck.disabled=true}if(!!blZ.onBtnClk){bi.bM(this.oN,"click",blZ.onBtnClk)}};byx.rJ=function(blZ){if(!!blZ.btnText)this.oN.innerText=blZ.btnText;if(!!blZ.btnClazz)byA.bJ(this.oN,blZ.btnClazz);bi.kS(this.oN,"click");bi.bM(this.oN,"click",this.Fr.byB(this));this.ck.disabled=false;this.wE()};byx.xP=function(){ul(this.ck)};byx.biL=function(byy){if(byy.srcElement===this.ck||byy.srcElement===this.ck.parentNode||byy.srcElement===this.AI)return;if(byy.ext&&byy.ext.srcElement&&(byy.ext.srcElement===this.ck||byy.ext.srcElement===this.ck.parentNode||byy.ext.srcElement===this.AI))return;this.uK();if(this.cTa){this.cTa.cTc()}};byx.clZ=function(){return this.PS&&byA.ey(this.qF,"z-over")}})();
(function(){var byz=NEJ.P,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.n"),bU=byz("nej.ut"),cmw=byz("nej.ui"),gD=byz("nm.w"),bR=byz("nm.l"),bTG=byz("nm.c"),bp=byz("nm.d"),bj=byz("nm.x"),byx,byD;var Ni={playlist:"playlist",album:"album",djprogram:"program",artist:"artist",song:"track",mv:"mv",djradio:"radio",comment:"comment"};gD.cKF=NEJ.C();byx=gD.cKF.bS(cmw.hl);byx.eo=function(){this.Yl="m-xwgt-publish-search"};byx.byL=function(){this.byO();var bg=byA.bV(this.bA,"j-flag");this.cMO=bg.shift();this.gW=bg.shift();this.cKZ=bg.shift();this.cKs=bg.shift();this.btH=[bg.shift(),bg.shift(),bg.shift(),bg.shift(),bg.shift()];this.cJZ=bg.shift();this.cKr=bg.shift();this.cKY=bg.shift();this.eZ={list:this.btH,index:0,selected:"z-curr",onchange:this.Av.byB(this)};bi.bM(this.gW,"keydown",this.cPC.byB(this));bi.bM(this.cKZ,"click",this.bBU.byB(this));bi.bM(this.cKr,"click",this.cNT.byB(this));bi.bM(this.cJZ,"click",this.cNT.byB(this));this.bL={onbeforelistload:this.Ak.byB(this),onafterlistload:this.cAh.byB(this)};this.cPG=["tracksingle_search_pub-","artist_search_pub-","album_search_pub-","playlist_search_pub-","program_search_pub-"];this.cPH=[{limit:100,parent:this.cJZ,item:"m-publish-search-single",cache:{klass:bp.cG,clear:true,data:{hlpretag:'<span class="s-fc2">',hlposttag:"</span>"},onerror:this.cLR.byB(this)},onbeforelistload:this.bL.onbeforelistload,onafterlistload:this.bL.onafterlistload},{limit:100,parent:this.cJZ,item:"m-publish-search-artist",cache:{klass:bp.bzI,clear:true,onerror:this.cLR.byB(this)},onbeforelistload:this.bL.onbeforelistload,onafterlistload:this.bL.onafterlistload},{limit:100,parent:this.cJZ,item:"m-publish-search-album",cache:{klass:bp.lA,clear:true,onerror:this.cLR.byB(this)},onbeforelistload:this.bL.onbeforelistload,onafterlistload:this.bL.onafterlistload},{limit:100,parent:this.cJZ,item:"m-publish-search-playlist",cache:{klass:bp.dZ,clear:true,onerror:this.cLR.byB(this)},onbeforelistload:this.bL.onbeforelistload,onafterlistload:this.bL.onafterlistload},{limit:100,parent:this.cJZ,item:"m-publish-search-djRadio",cache:{klass:bp.gr,clear:true,onerror:this.cLR.byB(this)},onbeforelistload:this.bL.onbeforelistload,onafterlistload:this.bL.onafterlistload}];bi.bM(bTG.bpf,"onplayingstatechange",this.cFC.byB(this));bi.bM(bTG.bpf,"onloadingstatechange",this.cFH.byB(this))};byx.cJ=function(blZ){this.cK(blZ);if(!!this.Aw){this.Aw.bQ();delete this.Aw}this.Aw=bU.cBY.bG(this.eZ);this.cwa=false;this.cKs.style.display="none";this.cKr.style.display="";this.cKX();byA.bEq(this.cMO,"box-srch","box-srchinit");this.gW.value="";this.gW.focus();this.cKW="";this.cvp=0;this.cPI=blZ.onInfoSend;bi.kS(this.cKY,"click");bi.bM(this.cKY,"click",function(){ctl.tempPlayer.cLF();blZ.onCancel()})};byx.cLi=function(){this.cLj()};byx.cPC=function(byy){if(event.keyCode==13){this.bBU()}};byx.bBU=function(){var value=this.gW.value.trim();if(value&&!!value.length){this.cKs.style.display="";this.cKr.style.display="none";byA.bEq(this.cMO,"box-srchinit","box-srch");bi.bF(this.bA,"resize");if(value!=this.cKW||this.cwa){this.cKW=value;this.cwa=false;this.Av({index:this.Aw.uG()})}}else{this.cKs.style.display="none";this.cKr.style.display="";this.cKX();byA.bEq(this.cMO,"box-srch","box-srchinit")}this.cKW=value};byx.cNT=function(byy){var chj=bi.cR(byy,this.cPJ);var bg=bi.cR(byy,this.cPK);var Ni={1:"playlist",2:"album",3:"djprogram",4:"song",6:"artist",70:"djradio"};if(!!bg){this.cJJ=bg.dataset.id;this.cLo=Ni[bg.dataset.type];if(this.cLo=="song"){var cJN=bp.cG.bG();if(!chj&&!dc.track.chV(this.cJJ)){dc.track.bJO(this.cJJ,"share");bi.bQd(byy);return}if(chj&&!dc.track.bVh(this.cJJ)){dc.track.bJO(this.cJJ);bi.bQd(byy);return}}if(this.cLo=="djradio"){if(byA.ey(bg,"z-noprogram")){bj.ci({txt:"不能分享没有节目的电台"});bi.bQd(byy);return}}if(this.cLo=="song"&&!!chj){var cJN=bp.cG.bG();var bB=cJN.cl(bg.dataset.id);byA.bJ(this.cMM,"z-pause ply-loading");bj.cVV(this.cMM,"icon.sp.svg#pub_play");this.cMM=chj;ctl.tempPlayer.cNU(bB)}else{this.cLg();ctl.tempPlayer.cLF()}bi.bQd(byy)}};byx.cPK=function(bv){return bv.tagName&&bv.tagName.toUpperCase()=="LI"};byx.cPJ=function(bv){return byA.ey(bv,"ply")};byx.cFC=function(byy){if(parseInt(byy.playId)!=this.cJJ)return;if(byy.playing){this.cvp=this.cvp|2}else{this.cvp=this.cvp&1}logger.debug(this.cvp,byy.playing,"tmpPlayStatus PlayingStateChange");switch(this.cvp){default:case 0:case 1:byA.bJ(this.cMM,"z-pause ply-loading");bj.cVV(this.cMM,"icon.sp.svg#pub_play");break;case 2:byA.bJ(this.cMM,"ply-loading");byA.bK(this.cMM,"z-pause");bj.cVV(this.cMM,"icon.sp.svg#pub_stop");break;case 3:byA.bJ(this.cMM,"z-pause");byA.bK(this.cMM,"ply-loading");break}};byx.cFH=function(byy){if(parseInt(byy.playId)!=this.cJJ)return;if(byy.loading){this.cvp=this.cvp|1}else{this.cvp=this.cvp&2}logger.debug(this.cvp,byy.loading,"tmpPlayStatus LoadingStateChange");switch(this.cvp){default:case 0:case 1:byA.bJ(this.cMM,"z-pause ply-loading");bj.cVV(this.cMM,"icon.sp.svg#pub_play");break;case 2:byA.bJ(this.cMM,"ply-loading");byA.bK(this.cMM,"z-pause");bj.cVV(this.cMM,"icon.sp.svg#pub_stop");break;case 3:byA.bJ(this.cMM,"z-pause");byA.bK(this.cMM,"ply-loading");break}};byx.cLR=function(byy){byA.eB(this.cJZ,"m-common-list-network-err")};byx.cPE=function(byy){byA.eB(this.cKr,"m-common-list-network-err")};byx.Av=function(byy){if(!this.cKW||byy<0||byy>4){return}ctl.tempPlayer.cLF();var blZ=this.cPH[byy.index];var cPL=this.cPG[byy.index];blZ.cache.lkey=cPL+this.cKW;if(typeof blZ.item=="string"){blZ.item={klass:blZ.item,commonJST:ctl.commonJST.cFB}}if(!blZ.cache.data){blZ.cache.data={}}blZ.cache.data.s=this.cKW;blZ.onemptylist=this.sW.byB(this,this.cKW);if(!!this.cw){this.cw=this.cw.bQ()}this.cw=bU.jN.bG(blZ)};byx.Ak=function(byy){byy.value=byA.gy("m-publish-search-loading")};byx.cAh=function(byy){this.cwa=true};byx.cKX=function(){var bxk=function(bB){if(!!bB.programId){return dc.program.cl(bB.programId)}else if(!!dc.track.bKN(bB)){return null}else{return bB}};return function(){var bZ=localCache.cF("host.profile.userId");var dk=dc.track.gB(),byj=dc.track.byI("track_history"),bg=[];if(!!dk){var gE={},bB=bxk(dk.data);if(!!bB){gE.track=bB;gE.playing=dk.state;bg.push(gE)}}var i=0,len=byj.length;while(bg.length<5&&i<len){var bB=bxk(byj[i].track);if(!bB){i++;continue}var bRO=false;for(var j=0,jj=bg.length;j<jj;j++){if(bB.id==bg[j].track.id){bRO=true;break}}if(!bRO){bg.push({track:bB})}i++}if(!bg.length){this.cKr.style.display="none";return}for(i=0,len=bg.length;i<len;i++){if(!bg[i].track){break}if(!bg[i].track.dj){bg[i].noCopyright=dc.track.bYQ(bg[i].track)}else{bg[i].noCopyright=false}}byA.eB(this.cKr,"m-publish-search-auto",{l:bg})}}();byx.sW=function(bu,byy){byA.eB(byy.parent,"m-publish-emtpy-message",{key:bu});byy.stopped=true};byx.cPF=function(){this.cKr.style.display="none"};byx.gF=function(byy){if(bj.hi(byy)){bj.ci({txt:"网络不给力哦，请检查你的网络设置~"});byy.stopped=true}};byx.cLg=function(){if(!!this.wA)this.wA.bQ();switch(this.cLo){case"djprogram":this.wA=bp.gr.bG();break;case"album":this.wA=bp.lA.bG();break;case"playlist":this.wA=bp.dZ.bG();break;case"song":case"yunsong":this.wA=bp.cG.bG();break;case"artist":this.wA=bp.bzI.bG();break;case"mv":this.wA=bp.bPF.bG();break;case"djradio":this.wA=bp.cmK.bG();break;default:logger.warn(this.cLo,"__getMusicItem","publish.search.js");return}var jC=this.wA.cl(this.cJJ);var bFo={};switch(this.cLo){case"djprogram":bFo.title=jC.name;bFo.author=jC.radio.name;bFo.summary=jC.description;bFo.picUrl=jC.coverUrl;break;case"album":bFo.title=jC.name;bFo.author=this.bqG(jC.artists);bFo.summary=jC.description;bFo.picUrl=jC.picUrl;break;case"playlist":bFo.title=jC.name;bFo.author=jC.creator.nickname;bFo.summary=jC.description;bFo.picUrl=jC.coverImgUrl;break;case"song":case"yunsong":var uE=bj.csw(jC);bFo.title=jC.name+(uE?"("+uE+")":"");bFo.author=this.bqG(jC.artists);bFo.summary="";bFo.picUrl=jC.album.picUrl;break;case"artist":bFo.title=jC.name;bFo.author="";bFo.summary="";bFo.picUrl=jC.img1v1Url;break;case"mv":bFo.title=jC.name;bFo.author=jC.artistName;bFo.summary=jC.desc;bFo.picUrl=jC.newCover;break;case"djradio":bFo.title=jC.name;bFo.author=jC.dj.nickname;bFo.summary=jC.desc;bFo.picUrl=jC.picUrl;break}bFo.status=true;this.cPI({id:this.cJJ,type:this.cLo,data:bFo,allData:jC})};byx.bqG=function(sR){if(!sR||sR.length==0)return"";var bE=[];sR.forEach(function(artist){bE.push(artist.name)});return bE.join("/")}})();
(function(){var byz=NEJ.P,byA=byz("nej.e"),cN=byz("nej.j"),cJO=byz("nej.o"),bi=byz("nej.v"),kB=byz("nej.ui"),bR=byz("nm.l"),qP,bpM;bR.SX=NEJ.C();qP=bR.SX.bS(bR.ir,!0);bpM=bR.SX.prototype;qP.eo=function(){this.Yl="m-rbnd-snspanel"};qP.byL=function(){this.byO();var bg=byA.bV(this.bA,"j-flag");this.zg=bg[0];this.Ik=bg[1];this.bzP=bg[2]};qP.EG=function(byy){this.dy()};qP.cJ=function(blZ){blZ.parent=document.body;blZ.draggable=true;blZ.mask="u-mask";this.cK(blZ);this.bpZ(blZ.type);this.NV(blZ.type);this.dO([[this.Ik,"click",this.EG.byB(this)]])};qP.NV=function(bq){byA.bJ(this.zg,"m-bweibo m-bdouban m-brenre m-btencent");var fX={2:"m-bweibo",3:"m-bdouban",4:"m-brenren",6:"m-btencent"};byA.bK(this.zg,fX[bq])};qP.bpZ=function(bq){switch(bq){case 2:case 3:case 4:case 6:this.bqa(bq);break}this.dD()};qP.bqa=function(bq){var fh=["snsType="+bq,"callbackType=Binding","clientType=pc"];var byC=APP_CONF.domain+"/api/sns/authorize?"+fh.join("&");this.bzP.src=byC}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bU=byz("nej.ut"),bj=byz("nm.x"),bxI=byz("nm.i"),bp=byz("nm.d"),bR=byz("nm.l"),bY=byz("nm.m"),bC=byz("nm.m.c"),bTG=byz("nm.c"),gD=byz("nm.w"),byx,byD,cQE={song:18,playlist:13,album:19,artist:36,djradio:28,djprogram:17,noresource:35},cQD=["playlist","djprogram","dynamic","album","song","mv","topic","text","pic","user","title","activity","subtitle","comment","djradio","yunsong","msg","artist"],cQr={djprogram:"节目",album:"专辑",playlist:"歌单",song:"单曲",yunsong:"单曲",artist:"歌手",mv:"MV",djradio:"电台",topic:"专栏文章"},cQq={djprogram:" - ",album:" - ",playlist:" by ",song:" - ",yunsong:" - ",artist:"",mv:" - ",djradio:" by ",topic:" by "};bC.SZ=NEJ.C();byx=bC.SZ.bS(bY.cW);byD=bR.MF.gZ;byx.byG=function(){this.bCU="m-share";this.dg();var bg=byA.bV(this.bA,"j-flag");this.cKV=bg.shift();this.bDr=bg.shift();this.oB=[bg.shift(),null,bg.shift(),bg.shift(),bg.shift()];this.bEj=this.bDr.parentNode.previousElementSibling;this.cML=bg.shift();this.dG={parent:this.cKV,onreply:this.Ij.byB(this),btnNode:this.cML,btnText:"分 享",btnClazz:"u-ibtn1 u-ibtnsz1 f-fr",editorClazz:"",enableBlank:true,remain:true,placeholder:"想说点什么"};window.NEJ_CONF={p_csrf:{cookie:"__csrf",param:"csrf_token"}};this.cJI=bTG.cJl.bG();bi.bM(bTG.cJl,"publish_end",this.bqN.byB(this))};byx.bqh=function(blZ){if(!!this.bqi)this.bqi.bQ();this.oC=this.bH.byI("user_bindings-"+this.fG.profile.userId);var eY=this.fW.hw();this.jv=eY.shareAccount;this.mK=eY.bindAccount;for(var i=0,l=this.oC.length;i<l;i++){if(!!this.oC[i]){if(this.oC[i].type==2){this.pw[0]=this.oC[i];if(!this.jv[0].bind){this.jv[0].bind=true;this.jv[0].show=true}this.mK[0].bind=true}else if(this.oC[i].type==3){this.pw[3]=this.oC[i];if(!this.jv[3].bind){this.jv[3].bind=true;this.jv[3].show=true}this.mK[3].bind=true}else if(this.oC[i].type==4){}else if(this.oC[i].type==6){}else if(this.oC[i].type==8){this.pw[4]=this.oC[i];if(!this.jv[4].bind){this.jv[4].bind=true;this.jv[4].show=true}this.mK[4].bind=true}}}for(var i=0,l=this.mK.length;i<l;i++){if(!this.pw[i]){this.jv[i].show=true;this.jv[i].bind=false;this.mK[i].bind=false;this.mK[i].update=false}if(!this.pw[i]||!this.jv[i].show||this.mK[i].bind&&!this.mK[i].update){byA.bK(this.oB[i],"z-gray")}else{byA.bJ(this.oB[i],"z-gray")}}};byx.Ij=function(){var cQC=function(bh){var bDs=[];for(var i=0,l=this.cei.length;i<l;i++){bDs.push(this.cei[i].userId)}this.BV={id:this.ll,type:this.dA,userIds:JSON.stringify(bDs),msg:bh.content};if(this.dA=="comment"){this.BV.threadId=this.MC}this.bqs.iL({key:"message_chat-add",data:this.BV})};var bqt=function(bg,ko,bE){var bzl=[];for(var i=0,l=bg.length;i<l;i++)if(!!bg[i]&&!byA.ey(ko[i],"z-gray"))bzl.push(bg[i].type);for(i=0,l=bE.length;i<l;i++){bE[i].show=false}for(i=0,l=bzl.length;i<l;i++){switch(bzl[i]){case 2:bE[0].show=true;break;case 3:bE[3].show=true;break;case 4:bE[2].show=true;break;case 8:bE[4].show=true;break}}return bzl};var cQn={djradio:"djRadio",djprogram:"program",artist:"resource"};var cQB=function(bh){var byy={eventTime:(new Date).getTime(),showTime:(new Date).getTime(),user:localCache.cF("host.profile"),type:cQE[this.dA]};if(!!this.cJL){byy.actId=this.cLT;byy.actName=this.cMJ}byy.json={msg:bh.content};var bq=this.dA;if(!!cQn[bq]){bq=cQn[bq]}if(this.dA!="noresource"){byy.json[bq]=this.cMI}if(!!bh.img){byy.pics=[];for(var i=0,len=bh.img.length;i<len;i++){byy.pics[i]={isLocal:true,originUrl:"orpheus://image/?path="+encodeURIComponent(bh.img[i]),rectangleUrl:"orpheus://image/?path="+encodeURIComponent(bh.img[i])+"&width=234&height=115",squareUrl:"orpheus://image/?path="+encodeURIComponent(bh.img[i])+"&width=115&height=115",pcRectangleUrl:"orpheus://image/?path="+encodeURIComponent(bh.img[i])+"&width=234&height=115",pcSquareUrl:"orpheus://image/?path="+encodeURIComponent(bh.img[i])+"&width=115&height=115"}}}logger.warn(byy,"_simulateEvent","share/index.js");return byy};var cQA=function(){var bE=[];bE.push(bm.WG(8));bE.push("share");bE.push(+(new Date));bE.push(localCache.cF("host.profile.userId"));bE.push(localCache.cg("deviceId"));return bm.wj(bE.join("-"))};return function(bh){this.ck.xk({btnText:"分享中",btnClazz:"z-dis"});if(!!this.Ig){cQC.call(this,bh)}else{this.bAM=bqt(this.pw,this.oB,this.jv||[]);var eY=this.fW.hw();eY.shareAccount=this.jv;this.fW.bI(eY);if(!!APP_CONF.sharePermission.pubEventWithoutResource&&!!this.cLw){if(!this.ck.ck.value&&!(this.ck.bbT&&this.ck.bbT.cNx().length)&&!this.cJQ){bj.ci({txt:"请输入内容"});this.ck.rJ({btnText:"分 享",btnClazz:"z-dis f-pea"});return}else if(!this.ll){this.dA="noresource"}}this.BV={id:this.ll,msg:bh.content,type:this.dA,active:this.cLw||0};if(this.dA=="comment"){this.BV.threadId=this.MC}if(!!this.cJQ&&!!this.cJQ.status||!!APP_CONF.sharePermission.pubEventWithoutResource&&!!this.cLw){if(!this.cLw){this.cvG=cQA();var blZ={data:this.BV,src:bh.img,nospread:this.cqC};blZ.sns={types:this.bAM};this.cJI.bhh(this.cvG,blZ)}else{this.cvG=-1;ctl.publishManager.bhh({data:this.BV,event:cQB.call(this,bh),src:bh.img,sns:{types:this.bAM}});this.ck.rJ({btnText:"分 享",btnClazz:"z-dis f-pea"});this.bF("onclose",{noConfirm:true})}}}}}();byx.bqN=function(bn){if(this.cvG!=bn.id){return}this.cvG=-1;bn=bn||cJO;this.ck.rJ({btnText:"分 享",btnClazz:"z-dis f-pea"});switch(bn.err){case 0:bj.ci({txt:"分享成功",state:"success"});this.bF("onclose",{noConfirm:true});break;case 404:bj.ci({txt:"您分享的音乐资源已被删除"});break;case 407:bj.ci({txt:"您输入的内容包含了敏感词汇，请重新检查"});break;case 408:bj.ci({txt:"请勿短时间内重复分享，会对别人刷屏的"});break;case 501:bj.ci({txt:"歌曲已从云盘删除"});break;case 302:break;case 315:bj.ci({txt:"根据对方设置，你没有该操作权限"});break;case 400:if(this.dA=="djradio"){bj.ci({txt:"不能分享没有节目的电台"})}else{bj.ci({txt:"因合作方要求，该资源不能分享"})}break;case 521:case 522:case 523:bj.ci({txt:"您没有该发布权限"});break;default:bj.ci({txt:"分享失败，请稍后再试"});break}};byx.dH=function(){this.dI();if(!!this.cJI){this.cJI=this.cJI.bQ()}};byx.wN=function(bh){bj.ci({txt:"分享成功！",state:"success"});this.bF("onclose",{noConfirm:true})};byx.bro=function(bh){bh=bh||cJO;this.ck.rJ({btnText:"分 享",btnClazz:"z-dis f-pea"});switch(bh.code){case 407:var dN="您输入的内容包含了敏感词汇，请重新检查";break;case 501:var dN="音乐云盘文件已不存在";break;case 315:var dN="根据对方设置，你没有该操作权限";break;case 400:var dN="因合作方要求，该资源不能分享";break;default:var dN="分享失败";break}bj.ci({txt:dN})};byx.byT=function(blZ){this.dO([[bTG.bFY,"bind",this.brr.byB(this)],[this.oB[0],"click",this.BN.byB(this,0)],[this.oB[1],"click",this.BN.byB(this,1)],[this.oB[2],"click",this.BN.byB(this,2)],[this.oB[3],"click",this.BN.byB(this,3)],[this.oB[4],"click",this.BN.byB(this,4)],[this.cKd,"click",this.cKU.byB(this)]]);this.cmx(blZ)};byx.brr=function(){this.bH.tw("user_bindings-"+this.fG.profile.userId,!1);this.bH.fE({key:"user_bindings-"+this.fG.profile.userId,offset:0,limit:10,data:{offset:0,limit:10,userId:this.fG.profile.userId}})};byx.cKU=function(){if(!!this.cJV)this.cJV.bQ();this.cJV=gD.cKF.bG({parent:this.bA.parentNode,onInfoSend:this.cKT.byB(this),onCancel:this.cKS.byB(this)});this.cJM=true;this.bA.style.display="none";nm.log.bTO("e143");bi.bF(this.bA,"resize")};byx.cKT=function(fz){this.ll=fz.id;this.dA=fz.type;this.cKt.style.display="none";this.cKf.style.display="";if(!!this.cJV)this.cJV.bQ();this.bA.style.display="";this.cJM=false;this.cJQ=fz.data;this.cMI=fz.allData;this.cMH(this.cJQ);this.ck.rJ({btnText:"分 享",btnClazz:"z-dis f-pea"})};byx.cKS=function(){if(!!this.cJV)this.cJV.bQ();this.bA.style.display="";this.cJM=false;bi.bF(this.bA,"resize")};byx.BN=function(bzU,byy){var bru=[2,6,4,3,8];if(!this.pw[bzU]||this.mK[bzU].bind&&!this.mK[bzU].update){bj.oA("sns.html",{snsType:bru[bzU],callbackType:"Binding",from:this.mK[bzU].bind&&!this.mK[bzU].update?"accredit":"bind",visible:!1})}else{if(byA.ey(this.oB[bzU],"z-gray"))byA.bJ(this.oB[bzU],"z-gray");else byA.bK(this.oB[bzU],"z-gray")}};byx.dq=function(blZ){this.bA.style.display="";this.cJM=false;this.cLw=false;this.cJL=false;if(!blZ.input.parent.firstChild)blZ.input.parent.appendChild(this.bA);else blZ.input.parent.replaceChild(this.bA,blZ.input.parent.firstChild);if(!!blZ.input.placeholder){this.dG.placeholder=blZ.input.placeholder}else{this.dG.placeholder="想说点什么"}this.dG.text=blZ.input.text||"";this.dG.action=blZ.input.action;this.kS("onclose");this.bM("onclose",function(byy){blZ.input.onclose(byy);ctl.tempPlayer.cLF()});this.pw=[];!!this.fW&&this.fW.bQ();this.fW=bp.gO.bG();this.cvG=-1;if(!!blZ.input.users){this.Ig=true;this.cei=blZ.input.users;if(!!this.bqs)this.bqs.bQ();this.bqs=bp.bzn.bG({onitemadd:this.wN.byB(this),onaddchaterr:this.bro.byB(this),onerror:this.gF.byB(this)});byA.bK(this.bEj,"last");this.bDr.style.display="none";this.dG.hideAt=true;this.dG.hideHash=true;this.dG.maxLen=140;this.dG.uploadLimit=0}else{this.Ig=false;byA.bJ(this.bEj,"last");this.bDr.style.display="";this.fG=localCache.cF("host");if(!!this.bH)this.bH.bQ();this.bH=bp.du.bG({onlistload:this.bqh.byB(this),onerror:this.gF.byB(this)});this.ll=blZ.input.rid;this.Ax=blZ.input.fid;this.dA=blZ.input.type;this.MC=blZ.input.fromData;this.cqC=!!blZ.input.nospread;this.cJQ=blZ.input.itemData;if(this.dA=="mv"||this.dA=="topic"||this.dA=="comment"){this.dG.uploadLimit=0}else if(!APP_CONF.sharePermission.pubEventWithPics){this.dG.uploadLimit=2}else{this.dG.uploadLimit=1}if(!!blZ.input.nospread){byA.bK(this.bDr,"f-dn")}else byA.bJ(this.bDr,"f-dn");this.Ax=blZ.input.fid;this.bH.tw("user_bindings-"+this.fG.profile.userId,!1);this.bH.fE({key:"user_bindings-"+this.fG.profile.userId,offset:0,limit:10,data:{offset:0,limit:10,userId:this.fG.profile.userId}});this.dG.hideAt=false;this.dG.hideHash=false;this.dG.maxLen=140}if(!!this.ck)this.ck.bQ();this.ck=bj.cMP.bG(this.dG);this.cJS=this.ck.cJS;this.cKd=this.ck.cKd;this.cKt=this.ck.cKt;this.cKf=this.ck.cKf;this.cKe=this.ck.cKe;if(!!blZ.input.users){this.cKG(blZ.input.users)}else{this.cKG()}bi.kS(this.cKd);if(!!blZ.input.isPub){bi.bM(this.cKd,"click",this.cKU.byB(this));if(!APP_CONF.sharePermission.pubEventWithoutResource){this.ck.xk({editorAbled:true,btnClazz:"z-dis f-pea",onBtnClk:this.cMG.byB(this)})}this.cJS.style.display="none";this.cKd.style.display="";this.cKR();this.cLw=true}else{this.cJS.style.display="";this.cKd.style.display="none";this.cKQ();this.cLw=false}if(!this.cJI){this.cJI=bTG.cJl.bG()}if(!!blZ.input.isActivity){this.cJL=true;this.cLT=blZ.input.actId;this.cMJ=blZ.input.actName;if(!!blZ.input.resourceJson){var bq=cQD[blZ.input.resourceType];if(!!bq){var cQe=true;var bFo={},jC=bj.mE(blZ.input.resourceJson);switch(bq){case"djprogram":bFo.title=jC.name;bFo.author=jC.radio.name;bFo.summary=jC.description;bFo.picUrl=jC.coverUrl;break;case"album":bFo.title=jC.name;bFo.author=this.bqG(jC.artists);bFo.summary=jC.description;bFo.picUrl=jC.picUrl;break;case"playlist":bFo.title=jC.name;bFo.author=jC.creator.nickname;bFo.summary=jC.description;bFo.picUrl=jC.coverImgUrl;break;case"song":case"yunsong":var uE=bj.csw(jC);bFo.title=jC.name+(uE?"("+uE+")":"");bFo.author=this.bqG(jC.artists);bFo.summary="";bFo.picUrl=jC.album.picUrl;break;case"artist":bFo.title=jC.name;bFo.author="";bFo.summary="";bFo.picUrl=jC.img1v1Url;break;case"mv":bFo.title=jC.name;bFo.author=jC.artistName;bFo.summary=jC.desc;bFo.picUrl=jC.newCover;break;case"djradio":bFo.title=jC.name;bFo.author=jC.dj.nickname;bFo.summary=jC.desc;bFo.picUrl=jC.picUrl;break;default:logger.warn(bq,"Invalid Type","share/index.js");cQe=false;break}if(!!cQe){this.dA=bq;this.cKt.style.display="none";this.cKf.style.display="";this.ll=jC.id;this.cJQ=bFo;this.cJQ.status=true;this.cMI=jC;this.cMH(this.cJQ);this.ck.rJ({btnText:"分 享",btnClazz:"z-dis f-pea"})}}}}else{this.cJL=false}this.ck.xP()};byx.cKG=function(bDs){if(!bDs||!bDs.length){this.cKe.innerText="";this.cKe.style.display="none";return}this.cKe.style.display="";this.cKe.innerText="分享给：";this.cKe.innerText+=bDs.map(function(byH){return byH.nickname}).join("，")};byx.cKk=function(bFo){var qh=this.cJS.firstElementChild;var YW=qh.getElementsByClassName("s-fc3")[0];qh.innerText="";YW.innerText="";if(typeof bFo=="string"){qh.innerText=bFo;qh.appendChild(YW);return}qh.innerText+=cQr[this.dA];var jV=cQq[this.dA];if(this.dA=="comment"){qh.innerHTML='<a class="s-fc2" href="#/m/personal/?uid='+bFo.uid+'">'+bFo.author+"</a>：";YW.innerHTML=bj.lO(bFo.title)}else{qh.innerText+="："+bFo.title;if(!!bFo.author){qh.innerText+=jV;YW.innerText=bFo.author}}qh.appendChild(YW)};byx.cMH=function(bFo){var qh=this.cKf.firstElementChild;var YW=qh.getElementsByClassName("s-fc3")[0];qh.innerText="";YW.innerText="";if(typeof bFo=="string"){qh.innerText=bFo;return}qh.innerText=cQr[this.dA];var jV=cQq[this.dA];qh.innerText+="："+bFo.title;if(!!bFo.author){qh.innerText+=jV;YW.innerText=bFo.author}qh.appendChild(YW)};byx.cKQ=function(){if(!!this.cJQ&&!!this.cJQ.status){this.cKk(this.cJQ);if(this.ck){this.ck.rJ({btnText:"分 享",btnClazz:"z-dis"})}return}else{this.cKk("载入中...");if(this.ck){this.ck.xk({btnClazz:"z-dis",editorAbled:true})}}};byx.cKR=function(){this.cKt.style.display="";this.cKf.style.display="none";if(!!this.cJV)this.cJV.bQ()};byx.cMG=function(byy){byA.bK(this.cKd,"info-err");setTimeout(function(){byA.bJ(this.cKd,"info-err")}.byB(this),500);bi.bQd(byy)};byx.bqG=function(sR){if(!sR||sR.length==0)return"";var bE=[];sR.forEach(function(artist){bE.push(artist.name)});return bE.join("/")};byx.gF=function(byy){if(bj.hi(byy)){bj.ci({txt:"网络不给力哦，请检查你的网络设置~"});byy.stopped=true}};byx.cKO=function(){if(!!this.ck){this.ck.bQ();delete this.ck}if(!!this.bH){this.bH.bQ();delete this.bH}if(!!this.cJV)this.cJV.bQ();delete this.Ig;delete this.fG;delete this.cei;this.pw=[]};byx.hA=function(bn){if(!bn||!bn.data||!bn.data.cmd)return;switch(bn.data.cmd){case"onenterpress":if(this.ck)this.ck.ED();break;case"onhide":this.cKO();break;case"aftershow":this.ck.xP();break;case"onbeforeclose":if(this.cMF()){this.bF("onclose",{noConfirm:false})}else{this.bF("onclose",{noConfirm:true})}break;case"itemload":this.cKQ();break}};byx.cMF=function(){if(!this.ck){return false}var cLU=(this.ck.bIl()||"").trim();if(!!this.cLw){if(!!this.cJM){return cLU&&!this.dgg(cLU)||!!this.ck.bbT&&this.ck.bbT.cNx().length>0}else{return!!this.cJQ&&!!this.cJQ.status||cLU&&!this.dgg(cLU)||!!this.ck.bbT&&this.ck.bbT.cNx().length>0}}else{return cLU&&!this.dgg(cLU)||!!this.ck.bbT&&this.ck.bbT.cNx().length>0}};byx.dgg=function(ds){var dgh=this.dG.text||"",ds=ds||"";return dgh&&ds.trim()==dgh.trim()};bj.cU("/?/share/",bC.SZ)})()</textarea>
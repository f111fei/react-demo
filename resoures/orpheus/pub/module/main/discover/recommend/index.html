<meta charset="utf-8"/> <textarea name="txt" id="m-drec-module"> <div class="p-recmd g-recmd g-wrap q-lrc j-flag"> <div></div> <div class="m-banner"></div> <a href="javascript:;" data-action="showTestTasteLayer" class="u-tag u-tag-redline u-tag-openrecmd"> <svg class="disk"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#tag_recmt"></use></svg>开启个性化推荐<i class="arr f-ff1 f-fs3">&gt;</i></svg> </a> <div class="u-head1"> <h2 class="u-tit f-ff2">推荐歌单</h2> <a href="#/m/disc/playlist/" class="morelink f-fr s-fc3" data-da-event="c322"> 更多<i class="arr f-ff1">&gt;</i> </a> </div> <ul class="m-list m-list-recmd m-list-flow f-flex"></ul> <div class="u-head1"> <h2 class="u-tit f-ff2">独家放送</h2> <a href="#/m/exclusive/" class="morelink f-fr s-fc3" data-da-event="c324"> 更多<i class="arr f-ff1">&gt;</i> </a> </div> <ul class="m-list m-list-excmv m-list-flow f-flex"></ul> <div class="u-head1"> <h2 class="u-tit f-ff2">最新音乐</h2> <a href="#/m/disc/newsong/" class="morelink f-fr s-fc3" data-da-event="c326"> 更多<i class="arr f-ff1">&gt;</i> </a> </div> <div></div> <div class="u-head1"> <h2 class="u-tit f-ff2">推荐MV</h2> <a href="#/m/mv/jingxuan/" class="morelink f-fr s-fc3" data-da-event="c328"> 更多<i class="arr f-ff1">&gt;</i> </a> </div> <ul class="m-list m-list-excmv m-list-excmv-mv m-list-flow f-flex"></ul> <div class="u-head1"> <h2 class="u-tit f-ff2">主播电台</h2> <a href="#/m/disc/djradio/home/" class="morelink f-fr s-fc3" data-da-event="c32a"> 更多<i class="arr f-ff1">&gt;</i> </a> </div> <ul class="m-list m-list-program m-list-recmd-program f-flex"></ul> <div class="m-adjustbar"> <p class="s-fc4">现在可以根据个人喜好，自由调整首页栏目顺序啦~</p> <button class="u-ibtn-redline" data-action="showAjustOrderLayer" data-da-event="c391">调整栏目顺序</button> </div> </div> </textarea> <textarea name="jst" id="m-drec-state"> {if state == 'loading'} {if showAnimation()} <div class="m-create"> <div class="creating"> ${commonJST('com-svg', 'icon.sp.svg#create', 'line')} </div> <h2 class="f-ff2 s-fc3">正在为你生成个性化推荐 <i class="dot"></i></h2> <p class="s-fc4 f-fs4 f-ff2">听得越多   推荐越准</p> </div> {else} <div class="u-load f-top">载入中...</div> {/if} {else} <div class="m-off"> <i class="icon u-icn u-icn-offline s-fc7"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#empty_offline"></use></svg></i> <h2 class="s-fc3">网络不给力哦，请检查你的网络设置~</h2> </div> {/if} </textarea> <textarea name="ntp" id="m-drec-order"> <section class="lyct m-adjustlay"> <p class="info"> <svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#lamp"></use></svg>想调整首页栏目的顺序？按住右边的按钮拖动即可 </p> <ul class="j-flag f-pr"></ul> <a class="lnk" href="javascript:;" data-action="restore" data-da-event="c3912">恢复默认排序</a> </section> <div class="lybt"> <button type="button" class="u-ibtn1 u-ibtnsz1" data-action="ok">确定</button> <button type="button" class="u-ibtn5 u-ibtnsz1" data-action="cc">取消</button> </div> </textarea> <textarea name="jst" id="m-drec-order-content"> {list order as item} <li data-id="${item.id}">${item.name|escape}<span class="dragger"></span></li> {/list} </textarea> <textarea name="ntp" id="m-drec-taste"> <div class="m-layer-taste-full"> <a class="icn cls" title="关闭窗体" data-action="cc"> <svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#close_l"></use></svg> </a> <section class="m-tastelay"><div class="wrap"></div></section> </div> </textarea> <textarea name="jst" id="m-drec-taste-loading"> <div class="u-load">载入中...</div> </textarea> <textarea name="jst" id="m-drec-taste-error"> <div class="s-fc3">获取数据失败，请稍后再试</div> </textarea> <textarea name="jst" id="m-drec-taste-content"> <h2 class="title f-ff2">选择你感兴趣的音乐标签</h2> {list tagArrays as tagArray} <ul class="m-taglist{if tagArray_index == tagArray_length-1}{/if}"> {list tagArray.tags as tag} {var selected = isSelected(tagArray.type, tagArray.multi, tag.key)} <li {if selected}class="z-sel"{/if} data-action="sel" data-type="${tagArray.type}" data-multi="${tagArray.multi}" data-key="${tag.key}">${tag.name|escape}</li> {/list} </ul> {/list} <a href="javascript:;" class="u-tag-indark u-tag-indark-hl finish" data-action="ok">完&nbsp;&nbsp;&nbsp;成</a> <p class="warn z-show">{if showEmpty}请至少选择1个标签{else}&nbsp;{/if}</p> </textarea> <textarea name="jst" id="m-drec-program"> {list beg..end as y} {var x = xlist[y]} {if x} {var program = x.program} {var radio = program.radio} {var data = 'data-res-type="3" data-res-action="play" data-res-id="'+program.id+'" data-res-from="'+from.fid+'"'} {var biAction = commonJST('com-bi-action', from.biEvent)} {var biEvent = commonJST('com-bi-event', from.biEvent)} {var daEvent = commonJST('com-da', from.daEvent)} <li ${commonJST('com-res', 3, program.id, '', true, from.fid, from.data, biAction)} ${commonJST('com-bi-json', from.biEvent, x, y)}> <div class="u-cover u-cover-md u-cover-hasply f-fl" ${data} ${biEvent} ${daEvent}> <a href="javascript:;" class="lnk"> ${commonJST('com-img-d', x.picUrl, '80y80', 'placeholder_cover_list.png')} </a> <span class="ply f-pa f-cp"> ${commonJST('com-svg', 'cover.sp.svg#play_rb')} </span> </div> <div class="cnt"> <h3 class="f-thide s-fc1"><a class="f-fs2" href="javascript:;" ${data} ${biEvent} ${daEvent}>${x.name|escape}</a></h3> <p><a href="${getAppLink(70, radio.id)}" class="s-fc4" ${biEvent} ${daEvent}>${radio.name|escape}</a></p> </div> </li> {/if} {/list} ${commonJST('com-flex-fix')} </textarea> <textarea name="jst" id="m-drec-playlist"> {list beg..end as y} {var x = xlist[y]} {if !!x} {if !!x.customItem} <li> <div class="cvr u-cover u-cover-daily u-cover-recmd" data-res-menu="true" data-res-type="21" {if x.showTestTasteLayer}data-res-data="showTaste"{/if}> <a {if x.showTestTasteLayer}data-action="showTestTasteLayer" data-type="daily"{else}href="${x.href}"{/if} class="lnk" data-da-event="c361"> <img src="orpheus://orpheus/style/res/common/discovery/calendar_bg.png"> <div class="date"> <div class="week s-fc3 f-ff2">${x.week}</div> <div class="day">${x.day}</div> </div> </a> <div class="reason f-pa f-tl"> <p class="f-thide2">${x.copywriter|escape}</p> </div> </div> <div class="desc"> <h3> <a {if x.showTaste}data-action="showTaste"{else}href="${x.href}"{/if} data-da-event="c361"> {if x.isBirthday} 生日特别推荐&nbsp;<span class="u-icn"><img src="orpheus://orpheus/style/res/common/discovery/birthday.png"></span> {else} 每日歌曲推荐 {/if} </a> </h3> </div> </li> {else} ${commonJST('com-playlist', x, from, y-1)} {/if} {/if} {/list} ${commonJST('com-flex-fix')} </textarea> <textarea name="jst" id="m-drec-banner"> <div class="pics"> <ul> {list beg..end as y} {var x = xlist[y]} <li data-log-type="${x.targetType}" data-log-id="${x.targetId}" data-log-url="${x.url}" data-log-pos="${y+1}" data-log-title="${x.typeTitle}" data-log-position="${y_index}" {if y==0} class="z-crt j-banner-li" {elseif y==1} class="z-nxt j-banner-li" {elseif y==end} class="z-prv j-banner-li" {else} class="j-banner-li" {/if}> <a ${target(x)}> {var delaySrc=x.imageUrl+delaySrcSuffix} {var lowSrc=x.imageUrl+lowSrcSuffix} <img src="{if isImgLoaded(delaySrc)}${delaySrc}{else}${defaultSrc}{/if}" delay-src="${delaySrc}" default-src="${defaultSrc}" onload="nm.l.f.cld(this)" onerror="nm.l.f.clde(this)"> </a> {if !!x.typeTitle&&!!x.titleColor} {var color = x.titleColor=='red'?'red':'blue'} <a ${target(x)} class="tag {if color=='blue'}tag-blue{/if}">${x.typeTitle|escape}<em></em></a> {/if} </li> {/list} </ul> {if xlist.length>1} <div class="arrbtns"> <a href="#" class="pre"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#banner_arr"></use></svg></a> <a href="#" class="nxt"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#banner_arr"></use></svg></a> </div> {/if} </div> <div class="btns"> {list beg..end as y} <span class="itm">&nbsp;</span> {/list} </div> </textarea> <textarea name="js">(function(){var byz=NEJ.P,cJO=NEJ.O,co=NEJ.F,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.cef"),bU=byz("nej.ut"),gD=byz("nm.w"),bj=byz("nm.x"),byx;if(!!gD.cYf)return;gD.cYf=NEJ.C();byx=gD.cYf.bS(bU.fQ);byx.byR=function(){this.bEc();this.cUW={1:{name:"song",link:""},10:{name:"album",link:"#/m/album/?id="},100:{name:"artist",link:"#/m/artist/?id="},1e3:{name:"list",link:"#/m/playlist/?id="},1001:{name:"dj",link:"#/m/program/?id="},1002:{name:"user",link:"#/m/personal/?uid="},1003:{name:"activity",link:""},1004:{name:"mv",link:"#/m2/mv/?source=banner&id="},1005:{name:"topic",link:"#/m/topic/?id="},1009:{name:"radio",link:"#/m/djradio?id="},2007:{name:"singleticket",link:""},2008:{name:"coupleticket",link:""},2009:{name:"debut",link:""},3e3:{name:"activity2"},3001:{name:"live",link:""},4001:{name:"activity3",link:"#/m/friend/activity?id="}};this.cWY={target:function(bzW){var bq=bzW.targetType,byF=this.cUW[bq];switch(bq){case 1003:case 2007:case 2008:case 2009:case 3e3:return'href="#" data-url="'+bzW.url+'"';case 3001:return'href="#" data-url="/live?id='+bzW.targetId+'"';case 1:return' data-song="'+bzW.targetId+'"';case 1001:return' data-program="'+bzW.targetId+'"';default:if(byF&&byF.link){return'href="'+byF.link+bzW.targetId+'"'}else{return'href="#"'}}}.byB(this),isImgLoaded:bj.cit,delaySrcSuffix:"?param=540y200&quality=100",lowSrcSuffix:"?param=54y20&quality=100",defaultSrc:bj.hk()["whiteBanner"]};this.kg=0;this.eZ={event:"mouseover",selected:"z-selected",onchange:this.bnK.byB(this)};this.bAo={}};byx.cJ=function(blZ){this.cK(blZ);this.cZI();this.fK=byA.cg(blZ.parent);this.cWL=blZ.list||[];this.bfC=blZ.moduleShow;if(this.fK&&this.cWL){this.dbP()}};byx.dbP=function(){this.dO([[this.fK,"click",this.zl.byB(this)],[this.fK,"mouseover",this.MO.byB(this)],[this.fK,"mouseout",this.bnD.byB(this)]]);byA.eB(this.fK,"m-drec-banner",NEJ.X({beg:0,end:this.cWL.length-1,xlist:this.cWL},this.cWY));this.qO=this.fK.getElementsByTagName("li");this.kg=this.qO.length;this.GN=0;if(!!this.tx)this.tx=this.tx.bQ();this.tx=bU.cBY.bG(NEJ.X({list:byA.bV(this.fK,"itm")},this.eZ));this.GL()};byx.bnK=function(byy){if(!this.fK||!this.cWL)return;if(byy.last!=null){var bzR=byy.last+this.kg;byA.bJ(this.qO[(bzR-1)%this.kg],"z-prv");byA.bJ(this.qO[bzR%this.kg],"z-crt z-current");byA.bJ(this.qO[(bzR+1)%this.kg],"z-nxt")}var bs=byy.index+this.kg;byA.bK(this.qO[(bs-1)%this.kg],"z-prv");byA.bK(this.qO[bs%this.kg],"z-crt");if(this.bfC){var cQ=this.qO[bs%this.kg],bIh=byA.bT(cQ,"logType"),bTe=byA.bT(cQ,"logId"),bTF=byA.bT(cQ,"logUrl"),bFd=byA.bT(cQ,"logTitle"),ctj=byA.bT(cQ,"logPosition"),bVG=bIh+":"+bTe+":"+bTF+":"+bFd;if(!this.bAo[bVG]){this.bAo[bVG]=!0;nm.log.cFs("bannerimpress",{type:bIh+"_"+bFd,url:bTF||null,id:bTe||null,position:ctj||null})}}byA.bK(this.qO[(bs+1)%this.kg],"z-nxt");setTimeout(function(bs){byA.bK(this.qO[bs%this.kg],"z-current")}.byB(this,bs),400);this.GN=bs%this.kg;this.GL()};byx.GL=function(){bj.cnk(this.cIS.byB(this),5e3,"discover_banner")};byx.cIS=function(){if(!this.Yx&&!localCache.cg("mq-hide")){this.GE()}else{this.GL()}};byx.GE=function(){this.GL();if(!!this.tx){this.tx.AX((this.GN+1+this.kg)%this.kg)}};byx.Yy=function(){this.GL();if(!!this.tx){this.tx.AX((this.GN-1+this.kg)%this.kg)}};byx.zl=function(byy){bi.bQd(byy);var bnZ=bi.cR(byy,"pre"),boa=bi.cR(byy,"nxt"),cQ=bi.cR(byy,"j-banner-li");if(bnZ){this.Yy();return}if(boa){this.GE();return}if(!cQ)return;if(byA.ey(cQ,"z-prv")){this.Yy();return}if(byA.ey(cQ,"z-nxt")){this.GE();return}if(byA.ey(cQ,"z-current")&&cQ.children[0]){nm.log.cFs("click",{type:"banners",object:byA.bT(cQ,"logType")+"_"+byA.bT(cQ,"logTitle"),url:byA.bT(cQ,"logUrl")||null,id:byA.bT(cQ,"logId")||null,position:byA.bT(cQ,"logPosition")||null});nm.log.bTO("c311");var jV=cQ.children[0],byC=byA.bT(jV,"url");if(!!byC){bj.caU(byC);return}var pr=byA.bT(jV,"song");if(!!pr){document.action({id:parseInt(pr),type:4,from:20,action:"play",href:"#"});return}var dB=byA.bT(jV,"program");if(!!dB){document.action({id:parseInt(dB),type:3,from:20,action:"play",href:"#",ext:"showPlaying"});return}var byC=byA.lh(jV,"href");if(!!byC)location.href=byC}};byx.MO=function(byy){this.Yx=true};byx.bnD=function(byy){this.Yx=false;this.GL()};byx.cZI=function(){if(this.fK&&this.cWL){this.fK.innerHTML="";this.Yx=!1;bj.cnk(null,0,"discover_banner");if(!!this.tx)this.tx=this.tx.bQ();this.RO();delete this.fK;delete this.cWL;delete this.qO}};byx.cZF=function(HB){this.bfC=!!HB;if(this.bfC){this.bAo={}}};byx.dH=function(){this.cZI();this.dI()}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,co=NEJ.F,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.cef"),bU=byz("nej.ut"),bp=byz("nm.d"),gD=byz("nm.w"),bj=byz("nm.x"),byx;if(!!gD.cYh)return;gD.cYh=NEJ.C();byx=gD.cYh.bS(bU.fQ);byx.byR=function(){this.bEc();this.cWY={playCountFormat:bj.bED};bi.bM(bp.du,"birthdaychange",this.clc.byB(this))};byx.cJ=function(blZ){this.cK(blZ);this.cWb();this.fK=byA.cg(blZ.parent);this.cY=blZ.list||[];this.dbQ=blZ.showTestTasteLayer;if(this.fK&&this.cY){this.cVW()}};byx.cVW=function(){var bg=this.cY.concat();var qY=bm.bql(localCache.cF("host.profile.birthday")),lz=new Date,iK={customItem:!0,week:bj.bSL(),day:lz.getDate(),isBirthday:lz.getMonth()==qY.getMonth()&&lz.getDate()==qY.getDate(),href:"#/m/dailysong/",showTestTasteLayer:this.dbQ,copywriter:"根据您的音乐口味生成每日更新"};bg.unshift(iK);byA.eB(this.fK,"m-drec-playlist",NEJ.X({beg:0,end:bg.length-1,xlist:bg,from:{fid:6,showRecommend:!0,coverSize:"194y194",biEvent:{action:"recommendclick",params:{scene:"user-playlist",id:{get:"id"},alg:{get:"alg"},position:{getIndex:!0},type:"list"}},daEvent:"c321"},commonJST:ctl.commonJST.cFB},this.cWY))};byx.clc=function(){if(this.fK&&this.cY){this.cVW()}};byx.cWb=function(){if(this.fK&&this.cY){delete this.fK;delete this.cY}};byx.dH=function(){this.cWb();this.dI()}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,co=NEJ.F,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.cef"),bU=byz("nej.ut"),gD=byz("nm.w"),bj=byz("nm.x"),byx;if(!!gD.cYi)return;gD.cYi=NEJ.C();byx=gD.cYi.bS(bU.fQ);byx.byR=function(){this.bEc()};byx.cJ=function(blZ){this.cK(blZ);this.cWb();this.fK=byA.cg(blZ.parent);this.cY=blZ.list||[];if(this.fK&&this.cY){this.cVW()}};byx.cVW=function(){byA.eB(this.fK,"com-list",{beg:0,end:this.cY.length-1,xlist:this.cY,from:{fid:6,item:"com-exclusive",flexFix:!0,coverSize:"335y188",biEvent:{action:"recommendclick",params:{scene:"user-unique",id:{get:"id"},alg:{get:"alg"},position:{getIndex:!0},type:{call:bj.VS,params:[{get:"type"}]},url:{get:"url"}}},daEvent:"c323"},commonJST:ctl.commonJST.cFB})};byx.cWb=function(){if(this.fK&&this.cY){this.fK.innerHTML="";delete this.fK;delete this.cY}};byx.dH=function(){this.cWb();this.dI()}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,co=NEJ.F,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.cef"),bU=byz("nej.ut"),gD=byz("nm.w"),bj=byz("nm.x"),bp=byz("nm.d"),byx;if(!!gD.cYj)return;gD.cYj=NEJ.C();byx=gD.cYj.bS(bU.fQ);byx.byR=function(){this.bEc();this.cu={nopager:!0,mopt:{limit:10,item:{from:{fid:6,biEvent:{action:"recommendclick",params:{scene:"user-newmusic",id:{get:"id"},alg:{get:"alg"},position:{getIndex:!0},type:"song",url:null}},daEvent:"c325"}},cache:{klass:bp.cG,lkey:"newsong"}}}};byx.cJ=function(blZ){this.cK(blZ);this.cWb();this.fK=byA.cg(blZ.parent);this.cY=blZ.list||[];if(this.fK&&this.cY){this.cVW()}};byx.cVW=function(){this.cu.parent=this.fK;this.cu.mopt.cache.list=this.cY.concat();this.byS=bj.lo.bG(this.cu)};byx.cWb=function(){if(this.fK&&this.cY){if(this.byS)this.byS=this.byS.bQ();delete this.cu.parent;delete this.cu.mopt.cache.list;delete this.fK;delete this.cY}};byx.dbR=function(){if(this.byS&&this.byS.ht){this.byS.ht.btp()}};byx.dH=function(){this.cWb();this.dI()}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,co=NEJ.F,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.cef"),bU=byz("nej.ut"),gD=byz("nm.w"),bj=byz("nm.x"),byx;if(!!gD.cYk)return;gD.cYk=NEJ.C();byx=gD.cYk.bS(bU.fQ);byx.byR=function(){this.bEc()};byx.cJ=function(blZ){this.cK(blZ);this.cWb();this.fK=byA.cg(blZ.parent);this.cY=blZ.list||[];if(this.fK&&this.cY){this.cVW()}};byx.cVW=function(){byA.eB(this.fK,"com-list",{beg:0,end:this.cY.length-1,xlist:this.cY,commonJST:ctl.commonJST.cFB,from:{fid:6,item:"com-mv",showRecommend:!0,flexFix:!0,coverSize:"335y188",biEvent:{action:"recommendclick",params:{scene:"user-mv",id:{get:"id"},alg:{get:"alg"},position:{getIndex:!0},type:"mv",url:null}},daEvent:"c327"}})};byx.cWb=function(){if(this.fK&&this.cY){delete this.fK;delete this.cY}};byx.dH=function(){this.cWb();this.dI()}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,co=NEJ.F,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.cef"),bU=byz("nej.ut"),gD=byz("nm.w"),bj=byz("nm.x"),byx;if(!!gD.cYl)return;gD.cYl=NEJ.C();byx=gD.cYl.bS(bU.fQ);byx.byR=function(){this.bEc();this.cWY={playCountFormat:bj.bED,getAppLink:bj.cXe}};byx.cJ=function(blZ){this.cK(blZ);this.cWb();this.fK=byA.cg(blZ.parent);this.cY=blZ.list||[];if(this.fK&&this.cY){this.cVW()}};byx.cVW=function(){byA.eB(this.fK,"m-drec-program",NEJ.X({beg:0,end:this.cY.length-1,xlist:this.cY,commonJST:ctl.commonJST.cFB,from:{fid:6,biEvent:{action:"recommendclick",params:{scene:"user-djradio",id:{get:"id"},alg:{get:"alg"},position:{getIndex:!0},type:"dj",url:null}},daEvent:"c329"}},this.cWY))};byx.cWb=function(){if(this.fK&&this.cY){this.fK.innerHTML="";delete this.fK;delete this.cY}};byx.dH=function(){this.cWb();this.dI()}})();
(function(){var byz=NEJ.P,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bj=byz("nm.x"),bR=byz("nm.l"),bh=null,byx,byD;if(bR.cYm)return;bR.cYm=NEJ.C();byx=bR.cYm.bS(bR.cWZ);byD=bR.ir.gZ;byx.eo=function(){this.kI="";this.Yl="m-drec-taste"};byx.byL=function(){this.byO();this.bNB=this.bA.lastElementChild.firstElementChild;bi.bM(this.bA,"click",this.ei.byB(this))};byx.cJ=function(blZ){blZ.hideNotelay=!0;blZ.destroyable=!0;blZ.title=blZ.title||"确认";this.cZy=blZ.ccText||"";this.cK(blZ);byA.eB(this.bNB,"m-drec-taste-loading");this.vy();byA.bK(this.bA,"z-show");if(bh){this.cZx(bh)}else{bj.cGp("/api/personalized/tags",null,this.cZx.byB(this))}};byx.cZx=function(bn){if(bn&&bn.code==200&&bn.result&&bn.result.length){bh=bn;this.cWv={};byA.bK(this.bNB,"z-ani");this.cVW()}else{byA.eB(this.bNB,"m-drec-taste-error");this.vy()}};byx.cVW=function(dbS){byA.eB(this.bNB,"m-drec-taste-content",{tagArrays:bh.result,isSelected:this.cZw.byB(this),showEmpty:!!dbS});this.vy()};byx.vy=function(){this.bNB.parentNode.style.height=this.bNB.clientHeight+"px"};byx.cZw=function(cWp,cWT,cWB){return bm.eT(this.cWv[cWp],cWB)>=0};byx.dbT=function(cWp,cWT,cWB){var dbU=this.cZw(cWp,cWT,cWB);if(dbU){var AB=this.cWv[cWp],bs=bm.eT(AB,cWB);if(bs>=0){AB.splice(bs,1)}if(AB.length==0)delete this.cWv[cWp]}else{var AB=this.cWv[cWp];if(!AB||!cWT){AB=[];this.cWv[cWp]=AB}AB.push(cWB)}byA.bJ(this.bNB,"z-ani");this.cVW()};byx.cZu=function(){if(!bh||!this.cWv)return;var cZt=bj.crs(this.cWv).length==0;if(cZt){byA.bJ(this.bNB,"z-ani");this.cVW(cZt)}else{bj.cGp("/api/personalized/tags/save",{tags:bj.ciE(this.cWv)},this.dbV.byB(this))}};byx.dbV=function(bn){if(bn&&bn.code==200){this.bF("ontastechange",{});this.dy()}else{bj.ci({txt:"保存口味测试数据失败，请稍后再试"})}};byx.ei=function(byy){var bv=bi.cR(byy,"d:action");if(bv){switch(byA.bT(bv,"action")){case"sel":var cWp=byA.bT(bv,"type"),cWT=byA.bT(bv,"multi")=="true",cWB=byA.bT(bv,"key");this.dbT(cWp,cWT,cWB);break;case"ok":this.cZu();break;case"cc":if(this.cZy){bj.ci({txt:this.cZy,state:"none"})}byA.bJ(this.bA,"z-show");setTimeout(function(){this.dy()}.byB(this),200);break}}};byx.xt=function(){this.cZu()}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,co=NEJ.F,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bD=byz("nej.cef"),bU=byz("nej.ut"),bTG=byz("nm.c"),bj=byz("nm.x"),byx;if(!!bTG.cYo)return;bTG.cYo=NEJ.C();byx=bTG.cYo.bS(bTG.cWt);byx.byR=function(){this.cWh={type:1e4,conf:{resource:function(bo){var byE={playlist:"播放列表",exclusive:"独家内容",newsong:"最新音乐",mv:"推荐MV",program:"主播电台"};return{id:bo,name:byE[bo]||bo,title:byE[bo]||bo}},sort:function(bh,cA,mZ,bg){bi.bF(document,"tempmessage",{from:bh.id,to:mZ.id})}},ddtip:{1e4:function(bh){return bh.name}}};this.bEc()};byz("ctl").discSortItem=bTG.cYo.kE()})();
(function(){var byz=NEJ.P,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bU=byz("nej.ut"),bj=byz("nm.x"),bR=byz("nm.l"),byx,byD;bR.cZr=NEJ.C();byx=bR.cZr.bS(bR.ir);byx.eo=function(){this.kI="z-show";this.Yl="m-drec-order"};byx.byL=function(){this.byO();this.bNB=byA.bV(this.bA,"j-flag")[0];bi.bM(this.bA,"click",this.ei.byB(this))};byx.cJ=function(blZ){blZ.hideNotelay=!0;blZ.destroyable=!0;this.cK(blZ);this.cXw=blZ.defOrder||[];this.cWM=blZ.curOrder||[];this.cWN=this.cWM.concat();this.KS=[];this.cVW()};byx.dH=function(){this.KS.forEach(function(cLZ,bs){if(cLZ.ctrl){cLZ.ctrl.bQ()}})};byx.cVW=function(){byA.eB(this.bNB,"m-drec-order-content",{order:this.cWN});var ko=this.bNB.getElementsByTagName("li");[].forEach.call(ko,function(bIO,bs){if(this.KS[bs]){this.KS[bs].ctrl.bQ()}var bl={};bl.ctrl=bU.bvX.bG({view:this.bNB,body:bIO,overflow:false,direction:2,isRelative:1,ondragstart:this.uf.byB(this,bl),onchange:this.cNy.byB(this,bl),ondragend:this.bBt.byB(this,bl)});bl.ele=bIO;this.KS[bs]=bl}.byB(this))};byx.uf=function(bl,eJ){bl.ele.style.zIndex="1"};byx.cNy=function(bl,eJ){var cLs,bzR=this.KS.length-1,cJi=this.KS.indexOf(bl);this.KS.forEach(function(cLZ,bs){if(bs!==cJi)cLZ.ele.style.top=""});if(eJ.top>0){cLs=(eJ.top+16)/50>>0;for(var i=1;i<=cLs&&i+cJi<=bzR;i++){this.KS[cJi+i].ele.style.top=-50+"px"}}else{cLs=(eJ.top-16)/50>>0;for(var i=-1;i>=cLs&&i+cJi>=0;i--){this.KS[cJi+i].ele.style.top=50+"px"}}};byx.bBt=function(bl,eJ){var cQc,bzR=this.KS.length-1,cJi=this.KS.indexOf(bl);this.KS.forEach(function(cLZ,bs){cLZ.ele.style.top=""});bl.ele.style.zIndex="";var dQ;if(eJ.top>0){cLs=(eJ.top+16)/50>>0;dQ=Math.min(cJi+cLs,bzR)}else{cLs=(eJ.top-16)/50>>0;dQ=Math.max(cJi+cLs,0)}this.KS.splice(cJi,1);this.KS.splice(dQ,0,bl);this.bNB.innerText="";for(var i=0,len=this.KS.length;i<len;i++){this.bNB.appendChild(this.KS[i].ele)}var cXX=this.cWN[cJi];this.cWN.splice(cJi,1);this.cWN.splice(dQ,0,cXX);nm.log.bTO("c3911")};byx.lU=function(){this.bF("onorderchange",{order:this.cWN});this.dy()};byx.ei=function(byy){var bv=bi.cR(byy,"d:action");if(bv){switch(byA.bT(bv,"action")){case"cc":this.dy();break;case"restore":this.cWN=this.cXw.concat();this.cVW();break;case"ok":this.lU();break}}};byx.xt=function(){this.lU()}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,eu=byz("nej.g"),byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bU=byz("nej.ut"),cN=byz("nej.j"),bj=byz("nm.x"),bxI=byz("nm.i"),bp=byz("nm.d"),bTG=byz("nm.c"),bY=byz("nm.m"),gD=byz("nm.w"),bR=byz("nm.l"),bC=byz("nm.m.d"),byx,byD;bC.Ys=NEJ.C();byx=bC.Ys.bS(bY.cW);byx.byG=function(){this.bCU="m-drec";this.dg();var bg=byA.gj(this.bA);this.cYq=bg.shift();this.cYr=bg.shift();this.cZq=bg.shift();this.cZp=bg.shift();this.cZo=bg.shift();this.cZn=bg.shift();this.cZl=bg.shift();this.cZk=bg.shift();this.cZj=bg.shift();this.cZi=bg.shift();this.cZh=bg.shift();this.cZg=bg.shift();this.cZf=bg.shift();this.cZe=bg.shift();this.cVY={banner:{klass:gD.cYf,box:this.cYr,checkDataNotChanged:function(cWi,cWj){return bj.cWJ(cWi,cWj,["targetType","targetId","url"])}},playlist:{klass:gD.cYh,tit:this.cZp,box:this.cZo,name:"推荐歌单",checkDataNotChanged:function(cWi,cWj,bcn){var bTL=["id"];if(bcn){bTL.push("playCount")}return bj.cWJ(cWi,cWj,bTL)},format:function(bg){return dc.playlist.hI("playlist_disc",bg)}},exclusive:{klass:gD.cYi,tit:this.cZn,box:this.cZl,name:"独家放送",checkDataNotChanged:function(cWi,cWj){return bj.cWJ(cWi,cWj,["type","id"])},format:function(bg){var bE=[];bm.cj(bg,function(bl){if(bl){bE.push(dc.exclusive.dah(bl))}});return dc.exclusive.hI("exclusive_disc",bE)}},newsong:{klass:gD.cYj,tit:this.cZk,box:this.cZj,name:"最新音乐",checkDataNotChanged:function(cWi,cWj){return bj.cWJ(cWi,cWj,["id"])},format:function(bg){var bE=[];bm.cj(bg,function(bl){if(bl&&bl.song){var YD=bj.bPL(bl.song);YD.alg=bl.alg;bE.push(YD)}});return dc.track.hI("newsong",bE)}},mv:{klass:gD.cYk,tit:this.cZi,box:this.cZh,name:"推荐MV",checkDataNotChanged:function(cWi,cWj,bcn){var bTL=["id"];if(bcn){bTL.push("playCount")}return bj.cWJ(cWi,cWj,bTL)},format:function(bg){return dc.mv.hI("mv_disc",bg)}},program:{klass:gD.cYl,tit:this.cZg,box:this.cZf,name:"主播电台",checkDataNotChanged:function(cWi,cWj){return bj.cWJ(cWi,cWj,["id"])},format:function(bg){var bE=[];bm.cj(bg,function(bl){if(bl&&bl.program){bE.push(bl.program)}});dc.program.hI("program_disc",bE);return bg}}};this.cYs=[this.cZp,this.cZo,this.cZn,this.cZl,this.cZk,this.cZj,this.cZi,this.cZh,this.cZg,this.cZf];this.bCf="";this.cWO("loading");this.cXw=["playlist","exclusive","newsong","mv","program"];this.cWM=ctl.setting.daJ("DISC_CONTENT_ORDER")||this.cXw;this.cZd();bi.bM(this.bA,"click",this.ei.byB(this));bi.bM(bTG.beh,"switch",this.bTQ.byB(this));this.bW=null;this.GQ=!1;this.cYt=!1;bi.bM(bp.dZ,"itemchange",this.cXj.byB(this,this.cVY.playlist.box,"1"))};byx.byT=function(blZ){this.cmx(blZ);if(this.cVY.banner&&this.cVY.banner.instance){this.cVY.banner.instance.cZF(!0)}this.dO([[location,"beforeurlchange",this.gv.byB(this)],[bj.lN,"change",this.hA.byB(this,{data:{cmd:"networkchange"}})]])};byx.dq=function(blZ){this.dC(blZ);if((blZ.param||cJO).cache&&this.bCf=="normal"&&!this.GQ){document.mbody.scrollTop=this.eV;return}this.cYu()};byx.bTQ=function(){ctl.setting.daI("DISC_CONTENT_REFRESH_DATE","");this.cWO("loading");if(this.bW)delete this.bW;for(var bq in this.cVY){var iK=this.cVY[bq];delete iK.oldData;if(iK.instance){iK.instance.bQ();delete iK.instance}}this.cZc()};byx.cZc=function(){this.GQ=!0};byx.cYu=function(){if(this.bCf=="normal"&&!this.GQ){}else{bj.cnk(null,0,"discover_recommend_refresh");if(this.bCf!="normal"||this.cYt){this.cWO("loading")}if(this.bCf=="normal"||this.cYt){dc.fragment.dbk(this.Hw.byB(this))}else{ctl.io.OO("disc_data",0,this.bck.byB(this))}}};byx.bck=function(bn){if(this.bCf!="normal"&&bn&&bn.err==0&&bn.ret){var bh=bn.ret;if(bh.userId&&bh.data&&bh.userId==localCache.cF("host.profile.userId")){bh=bh.data;if(bh.taste&&bh.banner&&bh.playlist&&bh.exclusive&&bh.mv&&bh.newsong&&bh.program){this.GQ=!0;this.cVW(bh)}}}dc.fragment.dbk(this.Hw.byB(this))};byx.Hw=function(bh){var gI="";if(!bh.taste){if(bh.code==eu.rp){gI="nonet"}else{gI="error"}}else if(!bh.banner.length||!bh.playlist.length||!bh.exclusive.length||!bh.mv.length||!bh.newsong.length||!bh.program.length){gI="error"}if(gI){this.GQ=!0;if(this.bCf=="normal"){}else if(this.bW){this.cVW(this.bW)}else{this.cWO(gI)}}else{this.GQ=!1;bj.cnk(this.cZc.byB(this),6e5,"discover_recommend_refresh");this.cVW(bh,!0);ctl.io.bUt("save disc_data","disc_data",{userId:localCache.cF("host.profile.userId"),data:bh},0)}};byx.cVW=function(bh,bcn){this.cYt=!1;this.bW=bh;var dbY=this.cYw!=!bh.taste.haveRcmd;this.cYw=!bh.taste.haveRcmd;for(var bq in this.cVY){var iK=this.cVY[bq],SP=bh[bq];if(iK.instance&&!dbY){if(iK.checkDataNotChanged(iK.oldData,SP,bcn)){if(bcn){iK.oldData=SP;if(iK.format){SP=iK.format.call(this,SP)}}continue}}iK.oldData=SP;if(iK.format){SP=iK.format.call(this,SP)}if(iK.instance){iK.instance.bQ();delete iK.instance}iK.instance=iK.klass.bG({parent:iK.box,list:SP,moduleShow:this.bfC,showTestTasteLayer:this.cYw})}this.cWO("normal");ctl.setting.daI("DISC_CONTENT_REFRESH_DATE",bj.HK())};byx.eR=function(){if(this.cVY.banner&&this.cVY.banner.instance){this.cVY.banner.instance.cZF(!1)}if(this.cVY.newsong&&this.cVY.newsong.instance){this.cVY.newsong.instance.dbR()}this.byU(!0);this.RO()};byx.bcB=function(){var HB=!1;if(this.cYt){HB=!0}else if(ctl.setting.daJ("DISC_CONTENT_REFRESH_DATE")!=bj.HK()){HB=!0}return HB};byx.cWO=function(dS){if(this.bCf==dS)return;this.bCf=dS;switch(dS){case"loading":case"nonet":case"error":case"none":byA.eB(this.cYq,"m-drec-state",{state:dS,showAnimation:this.bcB.byB(this),commonJST:ctl.commonJST.cFB});var bg=this.cYs.concat(this.cYr,this.cZq,this.cZe);bm.ij(bg,function(bk){byA.kO(bk)},this);this.bA.appendChild(this.cYq);break;case"normal":var bg=this.cYs.concat();if(this.cYw)bg.unshift(this.cZq);bg.unshift(this.cYr);bg.push(this.cZe);byA.kO(this.cYq);bm.cj(bg,function(bk){this.bA.appendChild(bk)},this);break}};byx.cZd=function(){var cYx=[];bm.cj(this.cWM,function(bl){cYx.push(this.cVY[bl].tit);cYx.push(this.cVY[bl].box)},this);this.cYs=cYx;if(this.bCf=="normal"){this.cWO("none");this.cWO("normal")}};byx.cZb=function(bg){var bzg=[];bm.cj(bg,function(bq){bzg.push({id:bq,name:this.cVY[bq].name})},this);return bzg};byx.ei=function(byy){var bv=bi.cR(byy,"d:action");if(bv){switch(byA.bT(bv,"action")){case"showAjustOrderLayer":bR.cZr.bG({title:"调整栏目顺序",clazz:"m-layer-adjust",defOrder:this.cZb(this.cXw),curOrder:this.cZb(this.cWM),onorderchange:this.dbZ.byB(this)}).dD();break;case"showTestTasteLayer":this.cZa(byA.bT(bv,"type"));break}}};byx.dbZ=function(byy){if(byy&&byy.order){var bg=[];bm.cj(byy.order,function(bl){bg.push(bl.id)});this.cWM=bg;this.cZd();ctl.setting.daI("DISC_CONTENT_ORDER",this.cWM)}};byx.cZa=function(bq){if(this.bEC){this.bEC.bQ()}this.bEC=bR.cYm.bG({ccText:bq=="daily"?"完成口味测试，才能开启每日歌曲推荐":"我们会根据你的收听行为自动计算口味",ontastechange:this.dca.byB(this,bq),mask:"m-mask m-mask-3"}).dD()};byx.dca=function(bq){if(bq=="daily"){location.hash="#/m/dailysong/"}this.GQ=!0;this.cYt=!0;this.cYu()};byx.hA=function(byy){if(!byy||!byy.data||!byy.data.cmd)return;switch(byy.data.cmd){case"clear":this.RO();this.bdG();break;case"networkchange":if(!navigator.offline&&this.cYy()){bj.cnk(this.ciN.byB(this),3e3,"disc_recm_3000");bj.cnk(this.ciN.byB(this),1e4,"disc_recm_10000");bj.cnk(this.ciN.byB(this),3e4,"disc_recm_30000")}break;case"mainPageShow":if(this.cYy()){bj.cnk(this.ciN.byB(this,!0),3e3,"disc_recm_3000");bj.cnk(this.ciN.byB(this,!0),1e4,"disc_recm_10000");bj.cnk(this.ciN.byB(this,!0),3e4,"disc_recm_30000")}break;case"showTasteLayer":this.cZa("daily");break}};byx.gv=function(byy){if(!!byy&&!!byy.oldValue&&(byy.oldValue.path==this.gq||!byy.oldValue.path)){this.eV=document.mbody.scrollTop}};byx.cYy=function(){return this.bfC&&this.bCf!="normal"&&this.bCf!="loading"};byx.ciN=function(cEb){if(this.cYy()&&(cEb||!navigator.offline)){this.GQ=!0;this.cYu()}};bj.cU("/m/disc/rec/",bC.Ys,!0)})()</textarea>
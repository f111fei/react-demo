<meta charset="utf-8"/> <textarea name="txt" id="m-rbnd-module"> <div class="g-wrap q-lrc"> <header class="u-head1"> <h2 class="u-tit f-ff2">绑定帐号</h2> </header> <div class="n-binds j-flag"></div> </div> </textarea> <textarea name="jst" id="m-rbnd-item"> <h3 class="head3 s-fc3 f-fs1">注册帐号</h3> <ul class="host"> {list hostAccounts as account} <li class="${account.klass}"> <div class="tit s-fc3"> <div class="cnt"> <div class="s-fc3 f-fs1">${account.name}</div> {if account.regiText} <p> ${account.regiText} {if account.type == 1} <a href='javascript:;' class="sep f-tdu s-fc2" data-action="replacePhone" data-type="${account.type}" data-cellphone="${account.uid}">更换手机</a> {/if} </p> {/if} </div> </div> <div class="btns"> {if account.type==2 || account.type==6} <a href="javascript:;" class="u-ibtn5" data-action="invate" data-type="${account.type}">寻找并邀请好友</a> {elseif account.type==1} {if account.hasPassword} <a href="javascript:;" class="u-ibtn5" data-action="resetPassword" data-type="${account.type}" data-cellphone="${account.uid}">修改密码</a> {else} <a href="javascript:;" class="u-ibtn5" data-action="password" data-type="${account.type}" data-cellphone="${account.uid}">设置密码</a> {/if} {/if} </div> </li> {/list} </ul> <h3 class="head3 head3-line s-fc3 f-fs1">其它登录方式</h3> <ul> {list loginAccounts as account} <li class="${account.klass}"> <div class="tit {if !account.bind}z-dis{/if}"> <div class="cnt"> <div class="s-fc3 f-fs1">${account.name}</div> {if account.bindText} <p>${account.bindText}</p> {/if} </div> </div> <div class="btns"> {if account.bind} {if account.type==2 || account.type==6} <a href="javascript:;" class="u-ibtn5" data-action="invate" data-type="${account.type}">寻找并邀请好友</a> {elseif account.type==1} {if account.hasPassword} <a href="javascript:;" class="u-ibtn5" data-action="resetPassword" data-type="${account.type}" data-cellphone="${account.uid}">修改密码</a> {else} <a href="javascript:;" class="u-ibtn5" data-action="password" data-type="${account.type}" data-cellphone="${account.uid}">设置密码</a> {/if} {/if} <button class="u-ibtn5" data-action="unbind" data-name="${account.name}" data-nick="${account.nick}" data-type="${account.type}" data-uid="${account.uid}" data-token="${account.token}">已绑定</button> {else} <button class="u-ibtn5 u-ibtn5-follow" data-action="bind" data-type="${account.type}"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_add"></use></svg>绑定</button> {/if} </div> </li> {/list} </ul> <h3 class="head3 head3-line s-fc3 f-fs1">绑定分享帐号</h3> <ul> {list shareAccounts as account} <li class="${account.klass}"> <div class="tit {if !account.bind}z-dis{/if}"> <div class="cnt"> <div class="s-fc3 f-fs1">${account.name}</div> {if account.bindText} <p>${account.bindText}</p> {/if} </div> </div> <div class="btns"> {if account.bind} {if account.type==2} <a href="javascript:;" class="uu-ibtn5" data-action="invate" data-type="${account.type}">寻找并邀请好友</a> {elseif account.type==1} <a href="javascript:;" class="u-ibtn5" data-action="resetPassword" data-type="${account.type}" data-cellphone="${account.uid}">修改密码</a> {/if} <button class="u-ibtn5" data-action="unbind" data-name="${account.name}" data-nick="${account.nick}" data-type="${account.type}" data-uid="${account.uid}" data-token="${account.token}">已绑定</button> {else} <button class="u-ibtn5 u-ibtn5-follow" data-action="bind" data-type="${account.type}"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_add"></use></svg>绑定</button> {/if} </div> </li> {/list} </ul> {if hostAccounts && hostAccounts.length} <button class="u-ibtn12 u-ibtnsz1 delbtn f-dn" data-action="delete" data-name="${hostAccounts[0].name}" data-nick="${hostAccounts[0].nick}" data-type="${hostAccounts[0].type}" data-uid="${hostAccounts[0].uid}" data-token="${hostAccounts[0].token}">删除帐号</button> {/if} </textarea> <textarea name="js">(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),cN=byz("nej.j"),bm=byz("nej.u"),bi=byz("nej.v"),bU=byz("nej.ut"),bj=byz("nm.x"),bTG=byz("nm.c"),bxI=byz("nm.i"),bR=byz("nm.l"),bp=byz("nm.d"),bY=byz("nm.m"),bC=byz("nm.m.r"),byx,byD;bC.YR=NEJ.C();byx=bC.YR.bS(bY.cW);byx.byG=function(){this.bCU="m-rbnd";this.dg();this.vI=byA.bV(this.bA,"j-flag")[0];this.byJ={onlistload:this.Oo.byB(this),onerror:this.ej.byP(this,false,this.vI)};bi.bM(this.bA,"click",this.ei.byB(this))};byx.byT=function(blZ){this.cmx(blZ);this.dO([[bTG.bFY,"bind",this.cBx.byB(this)],[bTG.bFY,"unbind",this.cBx.byB(this)],[bTG.bFY,"passwordset",this.cBx.byB(this)],[bTG.bFY,"passwordreset",this.cBx.byB(this)],[bTG.bFY,"cellphonereplace",this.cBx.byB(this)]]);if(!this.cGx)this.cGx=bTG.bFY.kE()};byx.dq=function(blZ){this.dC(blZ);this.cHI()};byx.cHI=function(){if(!!this.bH)this.bH=this.bH.bQ();this.bH=bp.du.bG(this.byJ);var bZ=localCache.cF("host.profile.userId");this.fP="user_bindings-"+bZ;this.bH.tw(this.fP,!1);this.bH.fE({key:this.fP,offset:0,limit:10,data:{offset:0,limit:10,userId:bZ}})};byx.Oo=function(blZ){if(blZ.key!=this.fP)return;var lJ=localCache.cF("host.account"),Nl=this.bH.byI(this.fP),CF=[{type:1,name:"手机",bind:!1,klass:"mb",bindText:""},{type:0,name:"网易邮箱帐号",bind:!1,klass:"wy",bindText:""},{type:10,name:"微信",bind:!1,klass:"wx",bindText:""},{type:5,name:"QQ",bind:!1,klass:"qq",bindText:""},{type:2,name:"新浪微博",bind:!1,klass:"sn",bindText:""},{type:3,name:"豆瓣",bind:!1,klass:"db",bindText:""},{type:8,name:"易信",bind:!1,klass:"yx",bindText:""}];for(var i=0,qW;qW=Nl[i];i++){for(var j=0,kG;kG=CF[j];j++){if(kG.type==qW.type){var eQ=JSON.parse(qW.tokenJsonStr);kG.bind=!0;switch(qW.type){case 0:kG.uid=eQ.email;kG.nick=eQ.email;kG.regiText=eQ.email;kG.bindText=eQ.email;break;case 1:kG.uid=eQ.cellphone;kG.nick=eQ.cellphone.substr(0,3)+"****"+eQ.cellphone.substr(7,4);kG.regiText="使用手机号注册："+kG.nick;kG.bindText="手机号："+kG.nick;kG.hasPassword=!!eQ.hasPassword;break;case 2:kG.uid=eQ.uid;kG.nick="";var bN=eQ.screen_name||eQ.name;if(!bN&&lJ.type==2&&lJ.snsnickname){bN=lJ.snsnickname}if(!!bN){kG.nick=bN;kG.regiText=bN;kG.bindText="ID："+bN}break;case 3:kG.uid=eQ.douban_user_id;kG.nick=eQ.douban_user_name;if(!!kG.nick){kG.regiText="ID："+kG.nick;kG.bindText="ID："+kG.nick}break;case 4:kG.uid=eQ.user.id;kG.nick=eQ.user.name;if(!!kG.nick){kG.regiText="ID："+kG.nick;kG.bindText="ID："+kG.nick}break;case 8:kG.uid=eQ.uid;kG.nick=eQ.nick;if(!!kG.nick){kG.regiText="ID："+kG.nick;kG.bindText="ID："+kG.nick}break;case 5:kG.uid=eQ.openid;kG.nick=eQ.nickname;var bN=kG.nick;if(bN){kG.regiText=bN;kG.bindText="ID："+bN}break;case 10:kG.uid=eQ.unionid;kG.nick=eQ.nickname;var bN=kG.nick;if(bN){kG.regiText=bN;kG.bindText="ID："+bN}break}kG.token=eQ.access_token;break}}}var cuD=[],cuC=[],cqY=[],cxt={0:!0,1:!0,2:!0,6:!0,5:!0,10:!0};bm.cj(CF,function(iR){if(iR.type==lJ.type)cuD.push(iR);else if(cxt[iR.type])cuC.push(iR);else if(iR.type!==6){cqY.push(iR)}},this);byA.eB(this.vI,"m-rbnd-item",{hostAccounts:cuD,loginAccounts:cuC,shareAccounts:cqY})};byx.ei=function(byy){var bk=bi.cR(byy,"d:action");if(!bk)return;bi.bQd(byy);switch(byA.bT(bk,"action")){case"invate":dispatcher.dr("/m/friend/find/invite/?type="+Number(byA.bT(bk,"type")));break;case"bind":this.cGx.cIH(Number(byA.bT(bk,"type")));break;case"unbind":this.boV(bk);break;case"password":this.cGx.cIJ(byA.bT(bk,"cellphone"));break;case"resetPassword":this.cGx.cxB(byA.bT(bk,"cellphone"));break;case"delete":var bq=Number(byA.bT(bk,"type")),bzh=byA.bT(bk,"nick"),bZ=byA.bT(bk,"uid"),hy=localCache.cF("host.profile.nickname");if(bq==1)bzh=bZ;this.cGx.cIN({type:bq,uid:byA.bT(bk,"uid"),nickname:localCache.cF("host.profile.nickname"),nick:bq==1?byA.bT(bk,"uid"):byA.bT(bk,"nick")});break;case"replacePhone":this.cGx.cHb(byA.bT(bk,"cellphone"));break}};byx.boV=function(cQ){var bq=Number(byA.bT(cQ,"type"));if(bq==2){bj.cHL(2,{source:APP_CONF["appkey"]["2"],uid:byA.bT(cQ,"uid"),access_token:byA.bT(cQ,"token")},this.bLL.byB(this,bq,cQ))}else{this.bLL(bq,cQ)}};byx.bLL=function(bq,cQ,bn){bn=bn||cJO;var hy=byA.bT(cQ,"nick")||"";if(!hy){hy=bn.screen_name||bn.nickname||""}this.cGx.cIL({type:bq,uid:byA.bT(cQ,"uid"),nick:hy,name:byA.bT(cQ,"name")})};byx.cBx=function(bn){this.cHI()};bj.cU("/m/friend/find/bind/",bC.YR)})()</textarea>
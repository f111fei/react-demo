<meta charset="utf-8"/> <textarea name="txt" id="m-yrd-program-module"> <div class="u-lhd j-flag"> <div class="g-wrap2 f-cb"> <h3 class="s-fc3">共<span class="j-flag">0</span>期</h3> <ul class="style u-stab j-flag"> <li data-res-action="desc" title="降序"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#stab_down"></use></svg></li> <li data-res-action="asc" title="升序"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#stab_up"></use></svg></li> </ul> </div> </div> <div class="u-msg u-msg-detail f-pr j-flag"></div> <div class="p-dtradio g-wrap1"><div data-res-shortcut="s-pg" class="m-tblist m-tblist-rdi j-flag"></div></div> <div class="j-flag"></div> </textarea> <textarea name="jst" id="m-yrd-goon-tip"> 上次听到：${last.name} <a data-res-type="3" data-res-action="play" data-res-from="70" data-res-id="${last.id}" data-res-data="${radioId}" data-id="${last.id}" data-ratio="${last.time>=0?(last.time/last.duration):0}" href="#" class="f-tdu s-fc1">继续播放</a> <span data-res-action="close" class="cls f-pa u-ibtn u-ibtn-1 s-fc1"></span> </textarea> <textarea name="jst" id="m-yrd-program-item"> {list beg..end as y} {var x=xlist[y]} {var state = checkPlay(x.id)} <div data-res-type="3" data-res-id="${x.id}" data-res-menu="true" data-res-from="70" data-res-data="${x.radio.id}" class="itm itm-${x.id} f-cb{if state} z-play{/if} j-item"> <div class="td s-fc4"> <em class="num">${x.serialNum}</em> {if state==2} <svg class="playstate"> <use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#list_play"></use> </svg> {else} <svg class="playstate"> <use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#list_pause"></use> </svg> {/if} </div> <div class="td"> <div class="u-cover u-cover-tn u-cover-hasply" data-res-action="play" data-res-id="${x.id}" data-res-type="3" data-res-from="70" data-res-data="${x.radio.id}"> <a href="javascript:;" class="lnk"> ${commonJST('com-img', x.coverUrl, '40y40')} </a> <span class="ply f-pa f-cp"><svg><use xlink:href="orpheus://orpheus/style/res/svg/cover.sp.svg#play_rb"></use></svg></span> </div> <h4 class="s-fc1 f-thide">${x.name|escape}</h4> </div> <div class="td s-fc4">播放：<span id="play_${x.id}">${tenThousand(x.listenerCount)||0}</span></div> <div class="td s-fc4">赞：<span id="liked_${x.id}">${tenThousand(x.likedCount)||0}</span></div> <div class="td s-fc4">${x.createTime|format:'yyyy-MM-dd'}</div> <div class="td f-pr s-fc4">${dur2time(x.duration/1000)}{if checkLatest(x.id)}<i  class="flag" data-res-action="play" data-res-id="${x.id}" data-res-from="70" data-res-data="${x.radio.id}" data-res-type="3"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#flag"></use></svg></i>{/if} </div> </div> {/list} </textarea> <textarea name="js">(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bU=byz("nej.ut"),bj=byz("nm.x"),bR=byz("nm.l"),qC=byz("nej.cef.ut"),bY=byz("nm.m"),bp=byz("nm.d"),gD=byz("nm.w"),bC=byz("nm.m.y"),coq,byx;bC.cYX=NEJ.C();byx=bC.cYX.bS(bY.cW);byx.byG=function(){this.bCU="m-yrd-program";this.dg();var bg=byA.bV(this.bA,"j-flag");this.cpt=bg[0];this.cwS=bg[1];this.jJ=bg[3];this.kw={limit:100,count:1,parent:bg[4],pager:{parent:bg[5],clazz:"m-page"},item:{klass:"m-yrd-program-item",dur2time:bj.AG,checkPlay:this.cwT.byB(this),tenThousand:bj.bED,checkLatest:this.cwU.byB(this),commonJST:ctl.commonJST.cFB},cache:{klass:bp.gr,data:{}},emptyText:"暂无节目",onbeforelistclear:function(){if(this.ht)this.ht.bQ();delete this.ht}.byB(this),onafterlistrender:function(byy){if(this.ht)this.ht.bQ();this.ht=bj.cot.bG({parent:byy.parent,data:this.cnc});this.cpx=this.kw.cache.data.asc?"asc":"desc";this.cnW.lg(this.cpx);if(this.cgC&&byy&&byy.offset==0){var cBX=byA.bV(this.kw.parent,"u-icn4-spk");if(!!cBX&&cBX.length){if(cBX[0]&&cBX[0].scrollIntoViewIfNeeded)cBX[0].scrollIntoViewIfNeeded()}}this.cgC=!1}.byB(this)};this.byJ={onitemload:this.cwV.byB(this)};this.cu={selected:"z-sel",dataset:"resAction",list:byA.gj(bg[2])}};byx.byT=function(blZ){this.csm=bp.cG.bG();this.cnw=bp.cmK.bG(this.byJ);this.cnH=bp.gr.bG();this.hP=bp.gO.bG();this.gp=this.hP.hw();coq=qC.NW.kE();this.cnW=bU.mP.bG(this.cu);this.cmx(blZ);this.dO([[this.bA,"click",this.btw.byB(this)],[bp.cG,"playchange",this.OZ.byB(this)],[bp.gr,"itemchange",this.FH.byB(this)]])};byx.dq=function(blZ){this.dC(blZ);this.cnc=blZ.param.id;this.cgC=!!blZ.param.fromSource;this.cnw.bvP(this.cnc);this.cnw.cwk(this.cnc);this.cnw.hv({id:this.cnc,key:"radio"});this.kw.parent.innerHTML=byA.gy("m-xwgt-list-loading")};byx.eR=function(){this.cnH.eN(this.kw.cache.lkey);this.byU();byA.bJ(this.jJ,"z-show");delete this.cpx};byx.bJx=function(){var bzH=this.cpx;this.cnW.lg(bzH);this.kw.cache.lkey="program_radio-"+this.cnc;this.kw.cache.data.radioId=this.cnc;if(bzH){this.kw.cache.data.asc=bzH=="asc";this.kw.cache.data.updateOrder=true}else{delete this.kw.cache.data.asc;delete this.kw.cache.data.updateOrder}if(this.cw)this.cw.bQ();this.cw=gD.cmG.bG(this.kw)};byx.cwV=function(byy){if(byy.id!=this.cnc)return;var cmP=this.cnw.cl(this.cnc),con=this.cnw.cwo(this.cnc),dk=this.csm.gB();if(con){var HB=false;if(!dk||!dk.data.programId){HB=true}else{var dB=this.cnH.cl(dk.data.programId);if(dB&&dB.radio&&dB.radio.id!=this.cnc){HB=true}else if(dB&&dB.radio&&dB.radio.id==this.cnc&&dk.state==1){HB=true}}if(HB){if(!con.duration||con.time<con.duration-1){byA.bK(this.jJ,"z-show");byA.eB(this.jJ,"m-yrd-goon-tip",{last:con,radioId:this.cnc})}this.csi=con.id}}this.cwS.innerText=cmP.programCount;this.bJx()};byx.btw=function(byy){var bk=bi.cR(byy,"d:resAction");switch(byA.bT(bk,"resAction")){case"play":var kz=byA.bT(bk,"ratio"),bo=byA.bT(bk,"id");if(kz&&bo){localCache.bSX("restoreProgramPlayRatio",{id:bo,ratio:Number(kz)})}byA.bJ(this.jJ,"z-show");break;case"close":byA.bJ(this.jJ,"z-show");bi.bQd(byy);break;case"asc":case"desc":bi.bQd(byy);if(byA.ey(bk,"z-sel"))break;this.cpx=byA.bT(bk,"resAction");this.cnw.cwl(this.cnc,this.cpx);this.cnH.eN(this.kw.cache.lkey);this.bJx();break}};byx.cwT=function(bo){var dk=this.csm.gB();if(!dk||!dk.data||dk.from.program!=bo)return 0;return dk.state};byx.cwU=function(bo){return this.csi==bo};var YG="z-play z-pause";var bvr={1:"z-pause",2:"z-play"};var bvA={1:"icon.sp.svg#list_pause",2:"icon.sp.svg#list_play"};byx.OZ=function(byy){var dF=byy.oldValue,eK=byy.newValue,bk;if(eK&&eK.data&&eK.data.programId){var dB=this.cnH.cl(eK.data.programId);if(dB&&dB.radio&&dB.radio.id==this.cnc){byA.bJ(this.jJ,"z-show");delete this.csi}}bk=this.kw.parent.querySelector(".itm-"+dF.data.programId||0);if(!!bk){byA.bJ(bk,YG)}bk=this.kw.parent.querySelector(".itm-"+eK.data.programId||0);if(!!bk){byA.bEq(bk,YG,bvr[eK.state]||"");bj.cVV(bk.querySelector(".playstate"),bvA[eK.state])}};byx.FH=function(byy){var bh=byy.data;if(byy.attr=="likedCount"){var bbZ=byA.cg("liked_"+bh.id);if(bbZ){bbZ.innerText=bh.likedCount||0}}};byx.hA=function(blZ){if(blZ.data&&blZ.data.cmd=="hideTip"){byA.bJ(this.jJ,"z-show")}};bj.cU("/m/djradio/",bC.cYX)})()</textarea>
<meta charset="utf-8"/> <textarea name="txt" id="m-lctck-module"> <div class="p-localtrack g-wrap1 q-lrc"> <div class="oper f-cb"> <div class="buttons"> <div class="u-ibtn5b"><span class="u-ibtn5 u-ibtn5-ply j-flag" data-res-action="play" data-res-type="13" data-log-action="playall" data-log-source="local" data-action="play"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_play_sml"></use></svg>播放全部</span><span title="添加全部到播放列表" class="u-ibtn5 u-ibtn5-only u-ibtn5-addto j-flag" data-res-action="queue" data-res-type="13" data-log-action="addtoall" data-log-source="local"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_addto_list"></use></svg></span></div> <button class="u-ibtn5 u-ibtn5-scan z-off j-flag" data-res-action="match" data-res-type="13" data-log-action="click" data-log-type="localmatch" data-action="match"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_scan"></use></svg>匹配音乐</button> </div> <div class="u-lcsch"> <input class="j-flag" type="text" data-res-type="16" data-res-menu="true" placeholder="搜索本地音乐"> <a class="sch-btn j-flag"> <svg> <use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#search"></use> </svg> </a> </div> </div> <div class="m-plylist m-plylist-local m-plylist-sort m-plylist_local-track" tabindex="1000" data-res-type="4" data-res-from="-3" data-res-data="" data-res-shortcut=""> <div class="head f-cb j-flag"> <div class="fix"> <div class="th col"></div> </div> <div class="flow"> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="title" data-log-action="sort" data-log-type="operation" data-log-source="local">音乐标题<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="0">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="artist" data-log-action="sort" data-log-type="operation" data-log-source="local">歌手<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="1">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="album" data-log-action="sort" data-log-type="operation" data-log-source="local">专辑<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="2">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="duration" data-log-action="sort" data-log-type="operation" data-log-source="local">时长<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="3">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="size" data-log-action="sort" data-log-type="operation" data-log-source="local">大小<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> </div> </div> <ul class="j-flag"></ul> </div> </div> </textarea> <textarea name="txt" id="m-mdwn-local-empty"> <div class="n-lmadd"> <h2 class="s-fc1">请添加本地音乐</h2> <p class="s-fc4">升级本地音乐为高品质音乐并和朋友分享！</p> <button class="u-ibtn1 u-ibtn1-xl f-ff2" data-action="folder">选择本地音乐文件夹</button> </div> </textarea> <textarea name="js">(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bU=byz("nej.ut"),bj=byz("nm.x"),bxI=byz("nm.i"),bp=byz("nm.d"),bY=byz("nm.m"),bC=byz("nm.m.r"),byx,byD;bC.bOc=NEJ.C();byx=bC.bOc.bS(bY.cW);byx.byG=function(){this.bCU="m-lctck";this.dg();var bg=byA.bV(this.bA,"j-flag");this.lZ=bg[0];this.bKF=bg[1];this.bJJ=bg[2];this.bIP=bg[3];this.Gj=bg[4];this.bLd=bg[5];this.Ov=bg[6];this.kk=this.Ov.parentNode;this.bhl=byA.bV(this.kk,"th");this.cu={parent:this.Ov,shortcutNode:this.kk,mopt:{limit:APP_CONF.local_page,item:{from:{fid:-3,isSortPlaylist:!0,vkey:"local"}},pager:{clazz:"m-page m-page-4"},cache:{data:{},lkey:"track_local"},onemptylist:this.nL.byB(this),onafterlistrender:this.hR.byB(this),onpagechange:this.bzC.byB(this),onbeforelistload:this.Ak.byB(this)},resizer:{parent:this.bLd,tableResizerKey:"local-track",noClearNode:!0}};this.fM={scanStep:1,discernStep:1,searchStep:1,sortStep:1,ext:null};bi.bM(this.bIP,"input",this.yu.byB(this));bi.bM(this.bIP,"focus",this.yu.byB(this));bi.bM(this.Gj,"click",this.bvx.byB(this));bi.bM(bp.cG,"searchdone",this.JU.byB(this));bi.bM(bp.cG,"listchange",this.ku.byB(this));bi.bM(location,"beforeurlchange",this.gv.byB(this));this.eV={};this.cZ=1;this.gY="";this.bin();this.bJs=!1;this.bOe=!1;this.ET=!1};byx.byT=function(blZ){this.cmx(blZ);if(!this.bJs){this.bJs=!0;bj.gM("/m/local",{cmd:"readzero"})}if(!this.bOe){this.bOe=!0;var bh=bj.cL(4,function(cJN){return cJN.BU()});if(bh.step==4){this.hA({data:{cmd:"scanend"}})}else{this.hA({data:{cmd:"scanstart"}})}}};byx.dq=function(blZ){this.dC(blZ);var bP=blZ.param||cJO,dM=blZ.input||cJO,bs=bP.index||dM.index,bKg=bP.s||dM.s||"",cJN=bP.cache||dM.cache||!1,cFe=bP.fromSource||dM.fromSource;if(cJN){if(this.cZ==(bs||1)){if(!this.gY){document.mbody.scrollTop=this.eV[this.cZ]}else{this.Fn=!0;this.bIP.value=this.gY;this.mi(this.gY,1)}return}else{if(this.gY){this.gY="";this.bin()}}}this.cgC=!!cFe;this.cZ=bs||1;if(this.gY&&!bKg&&!bs){this.Fn=!0;this.bIP.value=this.gY;this.mi(this.gY,1);return}this.Fn=!1;this.mi(bKg,this.cZ);if(!bKg)this.bIP.value=""};byx.mi=function(eF,bs){var cJN=this.cu.mopt.cache;var bqZ=cJN.lkey;cJN.lkey=eF.length==0?"track_local":"track_local_search-"+eF;cJN.data.keyword=eF;this.cu.mopt.pager.index=bs||1;if(cJN.lkey!="track_local"){this.cu.mopt.item.from.data="search-"+eF;this.bhy(this.cu.mopt.item.from.data);this.cu.mopt.cache.clear=!0;this.fM.searchStep=0}else{this.cu.mopt.item.from.data="";this.bhy(this.cu.mopt.item.from.data);this.cu.mopt.cache.clear=!0;this.fM.searchStep=1}if(bqZ!=cJN.lkey){this.fM.ext=null;delete this.cu.mopt.cache.data.orderData}this.gY=eF;this.bin();this.cu.mopt.item.mark=this.bAk(eF);byA.bT(this.lZ,"resData",this.cu.mopt.cache.data.keyword);byA.bT(this.bKF,"resData",this.cu.mopt.cache.data.keyword);if(this.fM.searchStep==0||this.ET){byA.bK(this.bJJ,"z-dis")}else{byA.bJ(this.bJJ,"z-dis")}if(!!this.byS)this.byS.bQ();this.byS=bj.lo.bG(this.cu)};byx.eR=function(blZ){this.byU(!0)};byx.bin=function(){if(this.gY){bj.cVV(this.Gj,"icon.sp.svg#colse");byA.bK(this.bIP.parentNode,"z-edit")}else{bj.cVV(this.Gj,"icon.sp.svg#search");byA.bJ(this.bIP.parentNode,"z-edit")}};byx.yu=function(){var bAq=true,sE=null;return function(byy){sE&&clearTimeout(sE);var eF=this.bIP.value.replace(/(^\s*)|(\s*$)/g,"");if(eF.length==0){if(this.gY!=eF)this.mi("",this.cZ||1);return}if(bAq){bAq=false;if(this.gY!=eF)this.mi(eF,1);setTimeout(function(){bAq=true}.byB(this),500)}else{sE=setTimeout(function(){this.yu()}.byB(this),500)}}}();byx.JU=function(byy){if(this.fM.searchStep!=0||byy.key!="track_local_search-"+this.gY)return;this.fM.searchStep=1;if(this.fM.ext&&this.Fn){this.Fn=!1;this.fM.sortStep=0;bj.cL(4,function(cJN){cJN.Xy({key:this.cu.mopt.cache.lkey,field:this.fM.ext.field,order:this.fM.ext.order})}.byB(this))}};byx.bvx=function(byy){this.bIP.value="";this.yu()};byx.ku=function(blZ){if(!blZ||blZ.key!=this.cu.mopt.cache.lkey)return;if(!!blZ.ext)this.fM.sortStep=1;if(!blZ.realAction||blZ.realAction!="delete"&&blZ.realAction!="search"){this.fM.ext=blZ.ext;if(blZ.realAction&&blZ.realAction=="match"){delete this.cu.mopt.cache.data.orderData}}};byx.nL=function(byy){this.cgC=!1;if(this.cu.mopt.cache.lkey=="track_local"){byy.value=byA.gy("m-mdwn-local-empty")}else{byy.value=byA.gk("m-mdwn-local-search-empty",{key:bj.fg(this.cu.mopt.cache.data.keyword)})}};byx.hR=function(byy){this.ZV();bj.gM("/m/local",{cmd:"rendered",box:byy.parent});if(this.cgC&&byy.options&&byy.options.offset==0&&!this.gY){var cBX=byA.bV(this.Ov,"z-play");if(!cBX||!cBX.length)cBX=byA.bV(this.Ov,"z-pause");if(cBX&&cBX.length){if(cBX[0]&&cBX[0].scrollIntoViewIfNeeded)cBX[0].scrollIntoViewIfNeeded()}}this.cgC=!1};byx.ZV=function(){bm.cj(this.bhl,function(bk){byA.bJ(bk,"asc desc")},this);if(this.fM.scanStep==1&&this.fM.discernStep==1&&this.fM.searchStep==1&&this.fM.sortStep==1){this.bBW()}else{this.IX()}};byx.bBW=function(){byA.bK("field-sort-"+this.cu.mopt.item.from.data+"-"+this.cu.mopt.item.from.fid,"sort");if(this.fM.ext||this.cu.mopt.cache.data.orderData){var bUL=this.fM.ext||this.cu.mopt.cache.data.orderData;byA.bK("field-"+bUL.field+"-"+this.cu.mopt.item.from.data+"-"+this.cu.mopt.item.from.fid,bUL.order)}};byx.IX=function(){byA.bJ("field-sort-"+this.cu.mopt.item.from.data+"-"+this.cu.mopt.item.from.fid,"sort")};byx.bAk=function(eF){if(!eF.length){return function(ds){return ds}}else{var bLe=new RegExp(bj.pD(eF),"gi");return function(ds){if(!ds)return;return ds.replace(bLe,function($1){return'<span class="s-fc2">'+$1+"</span>"})}}};byx.bzC=function(byy){if(byy.last==byy.index)return;if(!this.gY){dispatcher.dr(this.gq+"?index="+byy.index)}};byx.gv=function(byy){if(!!byy&&!!byy.oldValue&&byy.oldValue.path==this.gq){this.eV[this.cZ]=document.mbody.scrollTop}};byx.Ak=function(byy){byy.stopped=this.cu.mopt.cache.lkey=="track_local"};byx.hA=function(){var bIT=!1,bKA=!1;return function(byy){if(!byy||!byy.data)return;if(!!byy.data.windowEvent){!!this.byS&&this.byS.bJk(byy.data.windowEvent);return}switch(byy.data.cmd){case"scanstart":if(bIT)break;bIT=!0;this.ET=bIT;this.fM.scanStep=0;byA.bK(this.bJJ,"z-dis");byA.bK(this.bIP,"z-dis");this.ZV();break;case"scanend":if(!bIT)break;bIT=!1;this.ET=bIT;this.fM.scanStep=1;if(!this.gY)byA.bJ(this.bJJ,"z-dis");byA.bJ(this.bIP,"z-dis");this.ZV();break;case"clear":var bP=byy.data.param||cJO;if(this.cZ==(bP.index||1)){delete this.eV[this.cZ];this.RO();this.bdG()}break;case"emptychange":if(byy.data.empty){}else{}break;case"discernstart":if(bKA)break;bKA=!0;this.fM.discernStep=0;this.bJJ.innerHTML='<svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_scan"></use></svg>停止匹配';byA.bT(this.bJJ,"resAction","unmatch");byA.bK(this.lZ,"z-dis");byA.bK(this.bKF,"z-dis");byA.bK(this.bIP,"z-dis");this.ZV();break;case"discernend":if(!bKA)break;bKA=!1;this.fM.discernStep=1;this.bJJ.innerHTML='<svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_scan"></use></svg>匹配音乐';byA.bT(this.bJJ,"resAction","match");byA.bJ(this.lZ,"z-dis");byA.bJ(this.bKF,"z-dis");byA.bJ(this.bIP,"z-dis");this.ZV();break;case"beforescan":this.bvx();break;case"sort":if(this.cu.mopt.cache.lkey=="track_local"){this.cu.mopt.cache.data.orderData={field:byy.data.field,order:byy.data.order};bj.cL(4,function(cJN){cJN.eN("track_local");cJN.bJx("track_local")})}break;case"resetLimit":this.cu.mopt.limit=byy.data.limit;break}}}();byx.bhy=function(bh){bh=bh||"";byA.bJ(this.bLd,"sort");byA.bT(this.kk,"resData",bh);this.bLd.id="field-sort-"+bh+"--3";byA.bT(this.bLd,"resData",bh);bm.cj(this.bhl,function(bk,bs){var oU=byA.bT(bk,"resField");if(!!oU){byA.bJ(bk,"asc desc");bk.id="field-"+oU+"-"+bh+"--3";byA.bT(bk,"resData",bh)}},this)};bj.cU("/m/local/track/",bC.bOc,!0)})()</textarea>
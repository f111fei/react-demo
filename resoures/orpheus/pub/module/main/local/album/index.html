<meta charset="utf-8"/> <textarea name="txt" id="m-lcalb-module"> <div class="wrap"> <div class="srch"> <div class="u-lcsch u-lcsch-s"> <input class="j-flag" type="text" placeholder="查找专辑" data-res-menu="true" data-res-type="16"><a class="sch-btn j-flag"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#search"></use></svg></a> </div> </div> <div class="lcsd j-flag"></div> <div class="lclst"> <div class="u-resize2 j-flag"></div> <div class="oper f-cb"> <div class="buttons"> <div class="u-ibtn5b"> <span class="u-ibtn5 u-ibtn5-ply j-flag" data-res-from="-3" data-res-action="play" data-res-type="18" data-res-data="" data-log-action="playall" data-log-type="playall" data-log-source="localalbum"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_play_sml"></use></svg>播放全部</span><span class="u-ibtn5 u-ibtn5-only u-ibtn5-addto j-flag" title="添加全部到播放列表"data-res-from="-3" data-res-action="queue" data-res-type="18" data-res-data="" data-log-action="addtoall" data-log-source="localalbum"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#btn_addto_list"></use></svg></span> </div> </div> </div> <div class="m-plylist m-plylist-local m-plylist_local-view" tabindex="1000" data-res-type="4" data-res-from="-3" data-res-data="" data-res-shortcut=""> <div class="head f-cb j-flag"> <div class="fix"> <div class="th col"></div> </div> <div class="flow"> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="title" data-log-action="sort" data-log-type="operation" data-log-source="local">音乐标题<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="0">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="artist" data-log-action="sort" data-log-type="operation" data-log-source="local">歌手<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="1">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="album" data-log-action="sort" data-log-type="operation" data-log-source="local">专辑<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="2">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="duration" data-log-action="sort" data-log-type="operation" data-log-source="local">时长<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> <span class="js-resize" data-index="3">&nbsp;</span> <div class="th col" data-res-type="4" data-res-from="-3" data-res-data="" data-res-action="sort" data-res-field="size" data-log-action="sort" data-log-type="operation" data-log-source="local">大小<svg class="u-icn u-icn-sort-hvr"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort_hvr"></use></svg><svg class="u-icn u-icn-sort"><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#sort"></use></svg></div> </div> </div> <ul class="j-flag"></ul> </div> </div> </div> </textarea> <textarea name="jst" id="m-lcalb-list"> <ul class="n-sdlst n-sdlst-alb" tabindex="1000" data-res-type="18" data-res-from="-3" data-res-shortcut="s-local-album"> {if !!loading} <div class="u-load">加载中...</div> {else} {if xlist.length==0} {if keyword} <div class="empty s-fc3"> <span>未能找到与</span><span class="s-fc2 f-ff1">“</span><em class="f-thide s-fc2">${keyword}</em><span class="s-fc2 f-ff1">”</span><br> <span>相关的任何专辑</span> </div> {else} {/if} {/if} {list xlist as x} {var date = + new Date()} <li id="${prefix}${x.name}" data-res-type="18" data-res-from="-3" data-res-data="${x.name}" data-res-menu="true" {if x.name==curAlbum}class="z-sel"{/if}> <a href="#/m/local/album/?name=${encode(x.name)}&date=${date}" tabindex="0"> <div class="u-cover u-cover-tnalb"> <span class="lnk"><img src="${defaultPicUrl}" data-imgsrc="${getPicUrl(x)}" onerror="nm.m.f.amlderr(this)" data-name="${x.name}"></span> </div> <p class="f-thide">${mark(x.name)}</p> <p class="s-fc4">${x.total}首</p> </a> </li> {/list} {/if} </ul> </textarea> <textarea name="js">(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bU=byz("nej.ut"),bj=byz("nm.x"),bxI=byz("nm.i"),bp=byz("nm.d"),bY=byz("nm.m"),bR=byz("nm.l"),bLB=byz("nm.m.f"),bC=byz("nm.m.r"),byx,byD;bC.bNV=NEJ.C();byx=bC.bNV.bS(bY.cW);byx.byG=function(){this.bCU="m-lcalb";this.dg();var bg=byA.bV(this.bA,"j-flag");this.sy=bg[0];this.bOa=bg[1];this.bLz=bg[2];this.bSh=bg[3];this.rz=bg[4];this.bJF=bg[5];this.baZ=bg[6];this.baA=bg[7];this.cY=byA.bV(this.baZ,"th");this.cu={parent:this.baA,shortcutNode:this.baA.parentNode,mopt:{limit:APP_CONF.local_page,item:{from:{fid:-3,vkey:"local"}},showLoadTipDelay:!0,pager:{clazz:"m-page m-page-4"},cache:{clear:!0,data:{},lkey:""},onpagechange:this.bzC.byB(this),onemptylist:this.nL.byB(this),onafterlistrender:this.hR.byB(this)},resizer:{parent:this.baZ,tableResizerKey:"local-view",noClearNode:!0}};bi.bM(bp.cG,"listchange",this.ku.byB(this));bi.bM(bp.cG,"searchlocalviewload",this.bUp.byB(this,"searchlocalviewload"));bi.bM(bp.cG,"searchlocalviewdone",this.bUp.byB(this,"searchlocalviewdone"));bi.bM(bp.cG,"searchlocalviewchange",this.bUp.byB(this,"searchlocalviewchange"));bi.bM(this.sy,"input",this.yu.byB(this));bi.bM(this.sy,"focus",this.yu.byB(this));bi.bM(this.bOa,"click",this.bvx.byB(this));this.HF="";this.gY="";this.bin();this.bJq="auto-album-"+ +(new Date)+"-";bLB.amlderr=this.bLw.byB(this);this.bJs=!1;this.bOe=!1;this.bUs="";this.ri={begin:!1,x:0,y:0,now:182,min:182,max:182+10,minmax:182+10,mask:null,pmin:810,offset:810-3,mnminw:628,mnmaxw:778,mq:!1};this.fK=this.bSh.parentNode.parentNode;var bSf=byA.gj(this.fK);this.bSo=bSf[0];this.bSn=bSf[1];this.bfo=bSf[2];bi.bM(this.bSh,"mousedown",this.bfx.byB(this));bi.bM(document,"mousemove",this.bfy.byB(this));bi.bM(document,"mouseup",this.bfz.byB(this));bi.bM(window,"resize",this.bmY.byB(this));bi.bM(this.bLz,"scroll",this.bUY.byB(this))};byx.byT=function(blZ){this.cmx(blZ);if(!this.bJs){this.bJs=!0;bj.gM("/m/local",{cmd:"readzero"})}this.bLu();if(!this.bOe){this.bOe=!0;var bh=bj.cL(4,function(cJN){return cJN.BU()});if(bh.step==4){this.hA({data:{cmd:"scanend"}})}else{this.hA({data:{cmd:"scanstart"}})}}this.bEk();this.bUY()};byx.dq=function(blZ){this.dC(blZ);this.dv=bp.gO.bG();byA.bK(document.mbody,"z-noscr");var bP=blZ.param||cJO,dM=blZ.param||cJO,bN=bP.name||dM.name||"",bs=bP.index||dM.index||1;if(!!bN){byA.bJ(this.bJq+this.HF,"z-sel");this.HF=bN;byA.bK(this.bJq+this.HF,"z-sel");localCache.bSX("s-local-album",this.HF)}this.brf();this.cu.mopt.item.from.data="album-"+this.HF;this.cu.mopt.cache.lkey="track_local_album-"+this.HF;this.cu.mopt.cache.data.name=this.HF;this.cu.mopt.cache.data.orderData=dc.track.bkf(this.cu.mopt.cache.lkey);this.bhy("album-"+this.HF);!!this.byS&&this.byS.bQ(this.byS);this.byS=bj.lo.bG(this.cu);this.bJI();this.bQC()};byx.eR=function(blZ){this.byU();byA.bJ(document.mbody,"z-noscr");bj.gM("/m",{eventType:"localResize",inLocal:false,rnode:this.bfo,rminw:this.ri.mnminw})};byx.bQC=function(){var ov=!1;return function(){if(ov)return;ov=!0;this.bNW()}}();byx.bNW=function(){this.bUs=!!this.gY?"track_local_album_search-"+this.gY:"track_local_album";bj.cL(4,function(cJN){cJN.bWk(this.bUs,this.gY,"local_album")}.byB(this))};byx.bzC=function(byy){return};byx.nL=function(byy){byA.bK(this.rz,"z-dis");byA.bK(this.bJF,"z-dis");byy.value=byA.gy("m-lchom-right-empty")};byx.brf=function(){byA.bJ(this.rz,"z-dis");byA.bJ(this.bJF,"z-dis")};byx.ku=function(byy){var bu=(byy||cJO).key;if(bu=="track_local_album"){this.bNW()}else if(bu==this.cu.mopt.cache.lkey){this.bJI()}};byx.bin=function(){if(this.gY){bj.cVV(this.bOa,"icon.sp.svg#colse");byA.bK(this.sy.parentNode,"z-edit")}else{bj.cVV(this.bOa,"icon.sp.svg#search");byA.bJ(this.sy.parentNode,"z-edit")}};byx.yu=function(){var bAq=true,sE=null;return function(byy){sE&&clearTimeout(sE);var eF=this.sy.value.replace(/(^\s*)|(\s*$)/g,"");if(eF.length==0){if(this.gY!=eF){this.gY=eF;this.bin();this.bNW()}return}if(bAq){bAq=false;if(this.gY!=eF){this.gY=eF;this.bin();this.bNW()}setTimeout(function(){bAq=true}.byB(this),500)}else{sE=setTimeout(function(){this.yu()}.byB(this),500)}}}();byx.bvx=function(){this.sy.value="";this.yu()};byx.bAk=function(eF){if(!eF.length){return function(ds){return ds}}else{var bLe=new RegExp(bj.pD(eF),"gi");return function(ds){if(!ds)return;return ds.replace(bLe,function($1){return'<span class="s-fc2">'+$1+"</span>"})}}};byx.bJI=function(){byA.bT(this.rz,"resData",this.HF);byA.bT(this.bJF,"resData",this.HF)};byx.hA=function(){var bIT=!1;return function(byy){if(!byy||!byy.data)return;if(!!byy.data.windowEvent){!!this.byS&&this.byS.bJk(byy.data.windowEvent);return}switch(byy.data.cmd){case"scanstart":if(bIT)break;bIT=!0;byA.bK(this.rz,"z-dis");byA.bK(this.bJF,"z-dis");byA.bK(this.sy,"z-dis");break;case"scanend":if(!bIT)break;bIT=!1;byA.bJ(this.rz,"z-dis");byA.bJ(this.bJF,"z-dis");byA.bJ(this.sy,"z-dis");break;case"emptychange":if(byy.data.empty){}else{}break;case"beforescan":this.bvx();break;case"sort":if(this.cu.mopt.cache.lkey.indexOf("track_local_album")==0){this.cu.mopt.cache.data.orderData={field:byy.data.field,order:byy.data.order};bj.cL(4,function(cJN){cJN.eN(byy.data.key);cJN.bJx(byy.data.key)})}break}}}();byx.bLu=function(){var bk=byA.cg(this.bJq+this.HF);if(!!bk&&typeof bk.offsetTop!=="undefined"){bk.offsetParent.scrollTop=bk.offsetTop}};byx.bUp=function(bq,byy){if(!byy)return;if(byy.key!="track_local_album"&&byy.key!=this.bUs)return;switch(bq){case"searchlocalviewload":byA.eB(this.bLz,"m-lcalb-list",{loading:!0});this.bUY();break;case"searchlocalviewdone":var bs=bm.eT(byy.list,function(bl){return bl.name==this.HF}.byB(this));if(bs<0&&!!byy.list&&!!byy.list.length){this.HF=byy.list[0].name;localCache.bSX("s-local-album",this.HF);this.brf();this.cu.mopt.cache.lkey="track_local_album-"+this.HF;this.cu.mopt.cache.data.name=this.HF;this.bhy("album-"+this.HF);!!this.byS&&this.byS.bQ(this.byS);this.byS=bj.lo.bG(this.cu);this.bJI()}byA.eB(this.bLz,"m-lcalb-list",{loading:!1,xlist:byy.list,curAlbum:this.HF,prefix:this.bJq,defaultPicUrl:bj.hk().cover40,encode:encodeURIComponent,mark:this.bAk(this.gY),keyword:this.gY,getPicUrl:this.bqy});this.bUY();break;case"searchlocalviewchange":this.bNW();break}};byx.bLw=function(gm){if(!gm)return;if(!byA.bT(gm,"fail")){byA.bT(gm,"fail",1);byA.lh(gm,"src",bj.hk().cover40)}};byx.bqy=function(bl){if(!bl)return bj.hk().cover40;if(bl.picType==1){return APP_CONF.domain+"/api/album/getpic/"+bl.albumId+"?param=40y40&quality=100"}else{return APP_CONF.domain+"/api/search/album/pic?param=40y40&quality=100&name="+encodeURIComponent(bl.name)+"&artistname="+encodeURIComponent(bl.artist||"")}};byx.bfx=function(byy){this.ri.begin=!0;this.ri.x=byy.x;this.ri.y=byy.y;this.bDZ();if(!this.ri.mask){var bk=document.createElement("div");bk.style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;cursor:e-resize;z-index:99999;";this.ri.mask=bk}this.bLQ("resize");document.body.appendChild(this.ri.mask)};byx.bDZ=function(){this.bDV();this.ri.max=Math.max(this.ri.offset-this.ri.mnminw,this.ri.minmax)};byx.bDV=function(){this.ri.offset=Math.max(this.fK.offsetWidth,this.ri.pmin)-3};byx.bfy=function(byy){if(!this.ri.begin)return;var bEb=this.dv.bEd();var yP=bEb.side.width;var bze=byy.x-yP;if(bze>=this.ri.min&&bze<=this.ri.max)this.byn(bze);else if(bze<this.ri.min&&this.ri.now>this.ri.min)this.byn(this.ri.min);else if(bze>this.ri.max&&this.ri.now<this.ri.max)this.byn(this.ri.max)};byx.bfz=function(byy){if(!this.ri.begin)return;this.ri.begin=!1;this.bLQ("resizeEnd");this.ri.mask.parentNode.removeChild(this.ri.mask);nm.log.dE("stretch",null,null,{type:"localalbum"})};byx.byn=function(bze){if(this.ri.now==bze)return;if(bze<0)return;this.ri.now=bze;this.bSo.style.width=bze+"px";this.bSn.style.width=bze+"px";this.bfo.style.left=bze+"px";this.bDW();this.bEl("localside",bze)};byx.bDW=function(bEa){var bDX=this.ri.offset-this.ri.now;if(!!bEa&&bDX<this.ri.mnminw){this.byn(this.ri.offset-this.ri.mnminw);return}if(bDX>=this.ri.mnmaxw){if(this.ri.mq)return;this.ri.mq=!0}else{if(!this.ri.mq)return;this.ri.mq=!1}};byx.bmY=function(){this.bDV();this.bDW(!0);this.bLQ("resizeEnd")};byx.bEl=function(bq,bh){var bEb=bj.cL(11,function(cJN){return cJN.bEd()});if(!bEb)return;switch(bq){case"localside":if(bEb.localside.width==bh)return;bj.cL(11,function(cJN){cJN.bEo("localside",{width:bh})});break}};byx.bEk=function(){var bEb=this.dv.bEd();if(bEb.localside){var bze=bEb.localside.width;var bTz=document.body.offsetWidth;var bTy=bEb.side.width;var bTv=bTz-bTy-bze;if(bTv<this.ri.mnminw-10){bze=this.ri.min}}else{var bze=this.ri.min;this.dv.bEo("localside",{width:bze})}var cr=bEb.resolution.width-bEb.side.width;this.ri.offset=Math.max(this.fK.offsetWidth,this.ri.pmin,cr)-3;this.byn(bze);this.bLQ("resizeEnd");bj.gM("/m",{eventType:"localResize",inLocal:true,rnode:this.bfo,rminw:this.ri.mnminw})};byx.bLQ=function(bq){!!this.byS&&this.byS.bJk({data:{type:bq}})};byx.bUY=function(){var bKh=null,cV=1e3;var bVX=function(){var bVg=this.bLz.scrollTop,qo=this.bLz.clientHeight+bVg,bUq=this.bLz.firstElementChild;if(bUq&&bUq.firstElementChild&&bUq.firstElementChild.tagName&&bUq.firstElementChild.tagName.toLowerCase()=="li"){var clW=bUq.firstElementChild.offsetHeight,bVW=Math.max(0,Math.floor(bVg/clW)),bVS=Math.max(0,Math.ceil(qo/clW)),bVk=bUq.children;for(var i=bVW,ii=bVk.length;i<ii&&i<bVS;i++){var gm=bVk[i].firstElementChild.firstElementChild.firstElementChild.firstElementChild;if(!byA.bT(gm,"lazyload")){byA.bT(gm,"lazyload",1);gm.src=byA.bT(gm,"imgsrc")}}}};return function(){window.clearTimeout(bKh);bKh=window.setTimeout(bVX.byB(this),cV)}}();byx.hR=function(byy){bj.gM("/m/local",{cmd:"rendered",box:byy.parent});this.bBW()};byx.bhy=function(bh){bh=bh||"";byA.bJ(this.baZ.parentNode,"m-plylist-sort");bm.cj(this.cY,function(bk,bs){var oU=byA.bT(bk,"resField");if(!!oU){byA.bJ(bk,"asc desc");byA.bT(bk,"resData",bh)}},this)};byx.bBW=function(oU,bzH){var ih=this.cu.mopt.cache.lkey,bh=this.cu.mopt.cache.data.orderData;if(!!bh){var oU=bh.field,bzH=bh.order;bm.cj(this.cY,function(bk,bs){var cGu=byA.bT(bk,"resField");if(cGu){byA.bJ(bk,"asc desc");if(cGu==oU){byA.bK(bk,bzH)}}},this)}byA.bK(this.baZ.parentNode,"m-plylist-sort")};bj.cU("/m/local/album/",bC.bNV)})()</textarea>
<meta charset="utf-8"/> <textarea name="txt" id="m-fdtb-module"> <div class="m-pinfo"> <div class="j-flag" style="float:left;width:100%;"></div> <div class="tip f-dn j-flag u-arrlay u-arrlay-left u-arrlay-opacity">点这里还可以查看全部歌词</div> <div class="preload"></div> </div> </textarea> <textarea name="jst" id="m-fdtb-track"> <div class="u-cover u-cover-sm f-fl"> <a {if !from.fm} data-action="max" {else}href="#/m/fm/"{/if} data-log-type="cover" class="lnk"> <img class="j-cover" onerror="nm.m.f.lde('${tid}')"/> </a> </div> {var alias = getAlias(track)} <h3><a {if !from.fm} data-action="max" {else}href="#/m/fm/"{/if} data-log-type="title" title="${track.name}">${track.name|escape}{if alias}&nbsp;<span class="s-fc4">(${alias|escape})</span>{/if}</a></h3> <p data-action="max2"> {list track.artists as x} {if x} {if !x.id} <span>${x.name}</span> {else} <a href="#/m/artist/?id=${x.id}" class="s-ffc4">${x.name}</a> {/if} {/if} {if x_index<x_length-1}/{/if} {/list} </p> {if islike} <span class="icn icn-first f-cp icn-loved" data-da-event="b233" data-res-ext="playing" data-res-type="4" data-res-action="unlike" data-res-id="${track.id}" data-log-source="playdetail" title="取消喜欢">${commonJST('com-svg', 'btmbar.sp.svg#loved', 'svg')}</span> {else} <span class="icn icn-first f-cp" data-da-event="b233" data-res-ext="playing" data-res-type="4" data-res-action="like" data-res-id="${track.id}" data-log-source="playdetail" title="喜欢">${commonJST('com-svg', 'btmbar.sp.svg#love', 'svg')}</span> {/if} {if track.album && track.album.id != null&&!noShare} {if !from.fm} <span class="icn icn-second f-cp{if noCopyright} z-dis{/if}" data-da-event="b234" data-res-ext="playing" data-res-type="4" data-res-action="share" data-res-id="${track.id}" data-log-action="cltshare" data-log-type="song" data-log-source="playcard" title="分享">${commonJST('com-svg', 'btmbar.sp.svg#share', 'svg')}</span> {else} <span class="icn icn-second" data-action="trash">${commonJST('com-svg', 'btmbar.sp.svg#delete', 'svg')}</span> {/if} {/if} {if !from.fm} <span class="zoom f-cp" data-action="max" data-log-type="button" title="展开音乐详情页"> ${commonJST('com-svg', 'btmbar.sp.svg#max', 'svg f-vhc')} </span> {else} <a class="zoom f-cp" href="#/m/fm/" data-log-type="button" title="展开音乐详情页"> ${commonJST('com-svg', 'btmbar.sp.svg#max', 'svg f-vhc')} </a> {/if} <div class="u-arrlay u-arrlay-left u-arrlay-opacity tip f-dn">点这里还可以查看全部歌词</div> </textarea> <textarea name="jst" id="m-fdtb-program"> <div class="u-cover u-cover-sm f-fl"> <a href="#" data-action="max" class="lnk"> <img class="j-cover" onerror="nm.m.f.lde('${tid}')"/> </a> </div> <h3><a href="javascript:;" data-action="max" title="${track.name}">${track.name}</a></h3> {if program.radio} <p data-action="max2"><a href="#/m/djradio/?id=${program.radio.id}" class="s-ffc4">${program.radio.name}</a></p> {/if} {if !program.liked} <a href="javascript:;" class="icn icn-first f-cp" title="赞" data-da-event="b233" data-res-type="3" data-res-action="like" data-res-id="${program.id}" data-res-ext="like"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/btmbar.sp.svg#praise"></use></svg></a> {else} <a href="javascript:;" class="icn icn-praised icn-first z-ed" title="已赞" data-da-event="b233" data-res-type="3" data-res-action="like" data-res-id="${program.id}" data-res-ext="unlike" ><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/btmbar.sp.svg#praise"></use></svg></a> {/if} <a class="icn icn-second f-cp" data-da-event="b234" data-res-type="3" data-res-action="share" data-log-action="cltshare" data-log-type="dj" data-log-source="playcard" data-res-id="${program.id}" title="分享"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/btmbar.sp.svg#share"></use></svg></a> <span class="zoom f-cp" data-action="max" title="展开音乐详情页"><svg class="svg f-vhc"><use xlink:href="orpheus://orpheus/style/res/svg/btmbar.sp.svg#max"></use></svg></span> </textarea> <textarea name="ntp" id="m-fdtb-layer"> <section class="g-single"></section> </textarea> <textarea name="js">(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),bi=byz("nej.v"),bU=byz("nej.ut"),bm=byz("nej.u"),bD=byz("nej.n"),kB=byz("nej.ui"),qC=byz("nej.cef.ut"),bj=byz("nm.x"),bxI=byz("nm.i"),bR=byz("nm.l"),bp=byz("nm.d"),bTG=byz("nm.c"),bY=byz("nm.m"),bC=byz("nm.m.f"),byx,byD;bC.Uh=NEJ.C();byx=bC.Uh.bS(bY.cW);byx.byG=function(){this.bCU="m-fdtb";this.dg();var gR=byA.bV(this.bA,"j-flag");this.FO=gR[0];this.Ui=gR[1];this.eG={onitemload:this.Gx.byB(this)};this.kw={parent:document.body,onclose:this.bcY.byB(this)};bC.ld=this.bcZ.byB(this);bC.lde=this.bHP.byB(this);this.dv=bp.gO.bG();this.gp=this.dv.hw();bD.fo("likeclick","player",this.bRc.byB(this));bD.fo("recyle","player",this.cvu.byB(this));bD.fo("favour","player",this.cvs.byB(this));this.hU=ctl.cefPlayer};byx.byT=function(blZ){if(!this.hT)this.hT=bp.gr.bG(this.eG);if(!this.eh)this.eh=bp.cG.bG();this.dO([[this.FO,"click",this.ei.byB(this)],[bp.cG,"playchange",this.oD.byB(this)],[bp.gr,"itemchange",this.FH.byB(this)],[bp.cG,"lrcload",this.bdc.byB(this),!0],[bp.cG,"likechange",this.bJH.byB(this)],[bj.lN,"change",this.bjD.byB(this)],[bp.cG,"coverupdate",this.hA.byB(this,{data:{cmd:"coverupdate"}})],[bp.cG,"playingmatch",this.cJx.byB(this)]]);this.cmx(blZ);bj.gM("/m",{cmd:"init"})};byx.dq=function(blZ){this.dC(blZ);this.oD({newValue:bj.cL(4,function(cJN){return cJN.gB()})})};byx.bJH=function(byy,bHq){if(!this.cS||!byy)return;if(this.cS.programId){bD.cFB("player.setLikeMark",2);return}if(this.cS.id!=byy.id)return;var bKT=byy.like,bmi=!navigator.offline,dS=-1;if(bKT){dS=bmi?1:3}else{dS=bmi?0:4}bD.cFB("player.setLikeMark",dS);if(!bHq){this.bdd(this.cS,null,!0)}};byx.bjD=function(byy){if(!byy||!this.cS||this.cS.programId)return;var bo=this.cS.id,bKT=this.eh.bKK(bo);this.bJH({id:bo,like:bKT})};byx.bdc=function(byy){if(!byy)return;byy=byy.lyric;if(!byy||byy.nolyric||byy.uncollected||byy.lrc||!byy.source)return;logger.debug({"this.__userSetting.lyricTipFirstTime":this.gp.lyricTipFirstTime},"detail/brief/index.js","__doShowLyricTip");if(this.gp.lyricTipFirstTime!=false){byA.bJ(this.Ui,"f-dn");this.gp.lyricTipFirstTime=false;this.dv.bI(this.gp);logger.debug({"this.__userSetting.lyricTipFirstTime":this.gp.lyricTipFirstTime},"detail/brief/index.js","__doShowLyricTip");setTimeout(function(){byA.bK(this.Ui,"f-dn")}.byB(this),5e3)}};byx.ei=function(byy){var cA=this.eh.gB().from,cYv=false;if(cA.fm){cYv=true}if(byy.currentTarget==byy.target){if(!cYv){nm.log.dE("songbtn",null,null,{type:"card"});this.Fx()}else{location.href="#/m/fm/"}return}var bv=bi.cR(byy,"d:action");if(!bv)return;switch(byA.bT(bv,"action")){case"max":bi.bQd(byy);var bIh=byA.bT(bv,"logType");nm.log.dE("songbtn",null,null,{type:bIh});nm.log.bTO("b231");this.Fx();break;case"max2":if(!byy||!byy.srcElement||byy.srcElement.tagName!="P")return;bi.bQd(byy);if(cYv){location.href="#/m/fm/";nm.log.bTO("b231");return}var bIh=byA.bT(bv,"logType");nm.log.dE("songbtn",null,null,{type:bIh});this.Fx();break;case"trash":ctl.fmPlayer.cqt();break}};byx.bdd=function(bB,gi,bHs){var dk=this.eh.gB();if(!dk)return;var cA=dk.from,bKT=this.eh.bKK(bB.id),cDP=this.eh.cmI(bB)==2,cfD=this.eh.bYQ(bB.id);this.cuR();bj.cnk(function(){byA.eB(this.FO,"m-fdtb-track",{from:cA,track:bB,tid:this.Gt,islike:bKT,noCopyright:cfD,noShare:cDP,getAlias:bj.csw,commonJST:ctl.commonJST.cFB});var bh=this.eh.bNF(bB.id)||{},wz=bB.album.picUrl||bh.picUrl||bj.cnT(bB.album.picId_str||bB.album.picId)||bj.cnT(bh.picId_str||bh.picId);this.cDx(wz)}.byB(this),byA.ey(this.bA,"z-show")?0:500,"briefShowTrack");if(!bHs){this.bJH({id:bB.id,like:bKT},!0)}};byx.cuR=function(){if(document.getElementById("id-single")){byA.bJ(this.bA,"z-show");bj.gM("/?/frame/side/",{cmd:"cardhide",ishide:true});return}var hF=location.hash,cmF=hF.indexOf("?"),dY=cmF>=0?hF.substr(0,cmF):hF;if(dY=="#/m/fm/"&&(1==this.cuS()||-1==this.cuS())){byA.bJ(this.bA,"z-show");bj.gM("/?/frame/side/",{cmd:"cardhide",ishide:true})}else if(dY!="#/m/fm/"){byA.bK(this.bA,"z-show");bj.gM("/?/frame/side/",{cmd:"cardhide",ishide:false})}};byx.Um=function(dB){byA.eB(this.FO,"m-fdtb-program",{tid:this.Gt,dj:dB.dj,program:dB,track:this.cS});this.bJH({id:null,like:!1});this.cDx(dB.coverUrl)};byx.Gx=function(byy){if(this.cS.programId==byy.id){var dB=this.hT.cl(byy.id);bD.bX("player.setFavour",dB.liked?1:0);window.setTimeout(this.Um.byB(this,dB),20)}};byx.FH=function(byy){if(byy.attr!="likedCount")return;var dB=byy.data,bB=this.cS||cJO;if(dB.id!=bB.programId)return;bD.bX("player.setFavour",dB.liked?1:0);this.Um(dB)};byx.bcZ=function(){};byx.bHP=function(cCD){if(this.Gt!=cCD)return;this.cCG(cCD,"")};byx.cDx=function(wz){var cBb=[],bks=this.eh.cCH(this.cS.id);bm.cj(bks,function(gL){cBb.push("orpheus://cache/?orpheus://localmusic/pic?"+gL)});if(!!wz){var bs=(wz||"").indexOf("/16601526067802346.");if(bs>=0){cBb.push("orpheus://cache/?"+wz+"?param=60y60")}else{cBb.unshift("orpheus://cache/?"+wz+"?param=60y60")}}if(cBb&&cBb.length){bj.cCF(cBb,this.cCG.byB(this,this.Gt),"getPlayingBriefCover")}else{this.cCG(this.Gt,"")}};byx.cCG=function(cCD,byC){if(this.Gt!=cCD)return;if(!!byC){if(!this.eh.gB())byC="";if(!!byC){var bfP=(byA.bV(this.FO,"j-cover")||cJO)[0];if(!!bfP){bfP.src=byC}else{byC=""}}}byC=byC.replace("param=60y60","param=220y220");bj.cOi([byC],this.cix.byB(this,this.Gt,byC))};byx.cix=function(cCD,byC,bn){if(this.Gt!=cCD||!bn||!bn[byC]){return}if(byC.indexOf("orpheus://cache/?")==0){byC=byC.substr(17)}this.cCE=byC;logger.warn("cover -> "+byC,"__cbLoadCoverArray","/detail/brief/index.js");this.hU.bCI(byC);if(!!byC){bD.bX("app.setThumbnail",{albumCoverUrl:byC})}else{bD.bX("app.setThumbnail",{defaultCover:bj.hk().coverimg})}};byx.oD=function(byy){var dk=byy.newValue;if(!dk||dk.state==0){byA.bJ(this.bA,"z-show");this.FO.innerHTML="&nbsp;";this.cCE="";delete this.cS;bD.cFB("player.setLikeMark",2);return}};byx.bDC=function(byy,bBi){var dk=(byy||cJO).newValue;if(!dk||dk.state!=2&&!!this.cS&&!bBi)return;this.cS=bj.bKw(dk.data);this.pp=this.eh.cl(dk.from.fid==-3?dk.from.data:dk.from.fid==-2?"offline-"+this.cS.id:this.cS.id);this.Gt=dk.from.id;var cP=this.cS.programId;if(!!cP){this.hT.hv({key:"program",id:cP,data:{id:cP}});this.hT.bvP(cP);this.hT.hv({key:"program",id:cP,data:{id:cP}})}else{window.setTimeout(this.bdd.byB(this,this.cS,this.pp),50)}if(!this.jK){byA.bK(this.bA,"z-show")}if(this.jK){this.jK.bCF(byy)}};byx.Fx=function(){if(!!this.jK)return;bj.gM("/m/fm/",{cmd:"tomax"});byA.bJ(this.bA,"z-show");this.jK=bj.bAp.bG(this.kw)};byx.bcY=function(){delete this.jK;var dk=bj.cL(4,function(cJN){return cJN.gB()});if(!!dk&&dk.state!=0){byA.bK(this.bA,"z-show")}};byx.hA=function(bn){if(!bn||!bn.data||!bn.data.cmd)return;switch(bn.data.cmd){case"resize":this.bA.style.width=bn.data.width+"px";break;case"refresh":this.bDC(bn.data.ext,!!bn.data.update);break;case"setnativecover":if(bn.data.tid==this.Gt){if(this.cCE){this.hU.bCI(this.cCE,!0)}else{this.hU.bCI()}}break;case"coverupdate":if(this.eh){var dk=this.eh.gB();if(!!dk&&this.cS==(dk.data.track||dk.data)&&!this.cS.programId){bj.cnk(this.bdd.byB(this,this.cS,this.pp),60)}}break;case"min":if(this.jK)this.jK.bSD();break;case"max":this.Fx();break;case"fmonshow":case"fmonhide":this.cuR();break}};byx.cuS=function(){var dk=this.eh.gB();if(!dk)return-1;if(dk.from.hasOwnProperty("fm"))return 1;else return 0};byx.bRc=function(){if(!this.cS||this.cS.programId)return;var fk=this.cS.id,bKT=this.eh.bKK(fk);if(ctl.fmPlayer.Jj()){ctl.fmPlayer.cbY(!bKT)}else{document.action({id:fk,type:4,from:-1,logSource:"mini",action:bKT?"unlike":"like"})}};byx.cvu=function(){ctl.fmPlayer.cqt()};byx.cvs=function(bbZ){if(bbZ==0&&this.cS.programId){bj.cL(3,function(cJN){cJN.cuO(this.cS.programId)}.byB(this))}};byx.cJx=function(){if(this.eh){var dk=this.eh.gB();if(dk){this.bDC({newValue:dk},!0)}}};bj.cU("/?/frame/brief/",bC.Uh)})()</textarea>
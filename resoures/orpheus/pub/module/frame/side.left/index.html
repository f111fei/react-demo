<meta charset="utf-8"/> <textarea name="txt" id="m-fsdl-module"> <nav class="m-nav"> <div class="nav"> <h2 class="z-first">推荐</h2> <ul class="sys"> <li class="fx j-flag" data-id="/m/disc/"><a href="#/m/disc/rec/" data-da-event="b221"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#discover"></use></svg>发现音乐</a></li> <li class="fm j-flag" data-id="/m/fm/"><a href="#/m/fm/" data-da-event="b222"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#fm"></use></svg>私人FM</a></li> <li class="mv j-flag" data-id="/m/mv/"><a href="#/m/mv/jingxuan/" data-da-event="b223"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#mv"></use></svg>MV</a></li> <li class="py j-flag" data-id="/m/friend/home/"><a href="#/m/friend/home/" data-da-event="b224"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#friend"></use></svg><span class="j-flxg">朋友<i class="u-dot"></i></span></a></li> </ul> <h2 class="j-flag">我的音乐</h2> <ul class="sys" id="my-music-list"> <li class="bd j-flag" data-id="/m/local/"> <a href="#/m/local/track/" data-da-event="b225"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#local"></use></svg>本地音乐</a> <span class="state f-vc j-icn"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#list_pause"></use></svg></span> <span class="icn u-icn u-icn-scan"></span> </li> <li class="xz j-flag" data-id="/m/offline/"> <a class="j-flxg" href="#/m/offline/complete/" data-da-event="b226"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#dld"></use></svg>下载管理</a> <span class="state f-vc j-icn"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#list_pause"></use></svg></span> </li> <li class="cloud j-flag" data-id="/m/cloud/" data-dd-box="104"> <a href="#/m/cloud/" data-da-event="b2c"> <svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#cloud"></use></svg> 我的音乐云盘 </a> <span class="state f-vc j-icn"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#list_pause"></use></svg></span> </li> <li class="art j-flag" data-id="/m/fav/artist/"> <a href="#/m/fav/artist/" data-da-event="b228"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#artist"></use></svg>我的歌手</a> </li> <li class="mv j-flag" data-id="/m/fav/mv/"> <a href="#/m/fav/mv/" data-da-event="b227"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#mv"></use></svg>我的MV</a> </li> <li class="rdi j-flag" data-id="/m/fav/djradio/"> <a href="#/m/fav/djradio/" data-da-event="b229"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#radio"></use></svg><span class="j-flag">我的电台<i class="u-dot"></i></span></a> </li> </ul> <div class="j-hostplst"> <h2>创建的歌单<span class="newlist f-cp j-flxg" title="新建歌单" data-dd-box="103">新建</span><span class="ctrl f-pa f-cp j-flxg" title="收起"><svg><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#down"></use></svg></span></h2> <ul class="my j-flxg" tabindex="1001" data-res-type="1" data-res-from="-6" data-res-shortcut="s-side-left" data-da-event="b22a"></ul> <h2>收藏的歌单<span class="ctrl f-pa f-cp j-flxg" title="收起"><svg><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#down"></use></svg></span></h2> <ul class="my j-flxg" tabindex="1001" data-res-type="1" data-res-from="-6" data-res-shortcut="s-side-left" data-da-event="b22b"></ul> </div> <div class="import" style="display:none;"> <a href="#/m/import/" class="btn u-ibtn5" title="从虾米音乐/豆瓣FM导入歌单">导入歌单</a> <p class="s-fc4">从虾米音乐/豆瓣FM导入歌单</p> </div> </div> </nav> </textarea> <textarea name="jst" id="m-fsdl-playlist"> {list beg..end as y} {var x=xlist[y]} {var islke = lkeClass(x.id)} {if !isx(x.id)} <li draggable="true" class="gd j-flyg ${islke}" draggable="true" data-id="${x.id}" data-res-type="1" data-res-from="-6" data-res-menu="true" data-res-id="${x.id}" {if !defined("dd")||dd(x)} data-dd-sort="playlist-group-${defined('my')?'new':'fav'}" {/if} {if defined("my")}data-dd-box="1"{/if} id="${x.id}${tmpseed}"> <a tabindex="0" draggable="false" href="#/m/playlist/?id=${x.id}&rid=${x.commentThreadId|default:''}" data-id="${x.id}" draggable="false"><svg class="svg"><use xlink:href="orpheus://orpheus/style/res/svg/sidebar.sp.svg#${islke?'love':'song'}"></use></svg>${x.name|escape}</a><span class="state f-vc j-icn"><svg><use xlink:href="orpheus://orpheus/style/res/svg/icon.sp.svg#list_pause"></use></svg></span> </li> {/if} {/list} </textarea> <textarea name="ntp" id="m-fsdl-creator"> <li class="gd"><span class="edt"><input type="text" placeholder="歌单名称" class="j-flag"></span></li> </textarea> <textarea name="js">(function(){var byz=NEJ.P,byA=byz("nej.e"),bi=byz("nej.v"),cmw=byz("nej.ui"),bj=byz("nm.x"),bR=byz("nm.l"),bm=byz("nej.u"),sB=40,byx,byD;bj.Xi=NEJ.C();byx=bj.Xi.bS(cmw.hl);byx.cJ=function(blZ){this.cK(blZ);this.dO([[this.iy,"blur",this.lU.byB(this)],[this.iy,"keypress",this.hE.byB(this)],[this.iy,"input",this.vF.byB(this)]]);this.iy.value="";this.iy.focus()};byx.eo=function(){this.Yl="m-fsdl-creator"};byx.byL=function(){this.byO();this.iy=byA.bV(this.bA,"j-flag")[0]};byx.hE=function(byy){if(byy.keyCode==13){this.iy.blur()}};byx.lT=function(ds,kN){var bP={state:kN?"success":"",txt:ds};bj.ci(bP)};byx.vF=function(){var bO=this.iy.value.trim();if(bm.rV(bO)>sB){var bs;for(bs=sB;bm.rV(bO.slice(0,bs))>sB;bs--){}this.iy.value=bO.slice(0,bs)}};byx.lU=function(byy){var bO=this.iy.value.trim();if(bO.search(/@|#/)>-1){this.lT("歌单名不能包含@或#",false);if(byy&&byy.type=="blur")this.bF("onerror");return}this.bF("onok",{value:bO})}})();
(function(){var byz=NEJ.P,cJO=NEJ.O,byA=byz("nej.e"),bi=byz("nej.v"),bm=byz("nej.u"),bU=byz("nej.ut"),bj=byz("nm.x"),bxI=byz("nm.i"),bR=byz("nm.l"),bp=byz("nm.d"),bTG=byz("nm.c"),bY=byz("nm.m"),bC=byz("nm.m.f"),bD=byz("nej.n"),rU=28,bwL=150,byx,byD;bC.Xl=NEJ.C();byx=bC.Xl.bS(bY.cW);byx.byG=function(){this.bCU="m-fsdl";this.dg();var bg=byA.bV(this.bA,"j-flxg");this.Xm=bg.shift();this.bNH=bg.shift();this.dbA=bg.shift();this.cWQ=bg.shift();this.cXl=bg.shift();this.cXM=bg.shift();this.cXO=bg.shift();this.bNI=byA.bV(this.bA,"j-hostplst")[0];this.dO([[this.dbA,"click",this.Bn.byB(this)],[this.cWQ,"click",this.cZv.byP(this,0)],[this.cXM,"click",this.cZv.byP(this,1)],[bp.dZ,"addfav",this.bIb.byB(this)],[bp.mx,"message",this.Jf.byB(this)],[bj.lN,"change",this.bjD.byB(this)],[bp.cG,"playchange",this.CC.byB(this)],[document,"menuaction",this.bkw.byB(this)],[bp.cG,"offlinechange",this.bNJ.byB(this)],[bp.cG,"scanprogress",this.bbO.byB(this)],[bTG.beh,"switch",this.bKu.byB(this)],[bp.mo,"hostfavinfochange",this.bZW.byB(this)],[location,"urlchange",this.VV.byB(this)],[document,"dragstart",this.uf.byB(this)]]);var gR=byA.bV(this.bA,"j-flag");this.cfc=gR[3];this.cNd=gR[5];this.cqm=gR[7];this.chA=gR[8];this.chB=gR[9];this.chC=gR[10];this.cqv=gR[11];this.Xn=bU.mP.bG({selected:"z-sel",list:gR});this.byJ={parent:this.bky.byB(this),onok:this.bkz.byB(this),onerror:this.Xo.byB(this)};this.pM={};this.Xp={};this.Xq={};this.bBJ={limit:1e3,parent:this.cXl,item:{klass:"m-fsdl-playlist",my:!0,isx:bj.ol,dd:this.bkF.byB(this),tmpseed:byA.LK(),lkeClass:this.bkZ.byB(this)},cache:{klass:bp.dZ,onitemadd:this.bkG.byB(this)},onemptylist:this.qM.byB(this,"none"),onbeforelistload:this.jG.byB(this),onbeforelistrender:this.qM.byB(this,""),onbeforelistclear:this.tV.byB(this,"playlist_new"),onafterlistrender:this.hR.byB(this,"playlist_new")};this.Xr={limit:1e3,parent:this.cXO,item:{klass:"m-fsdl-playlist",isx:bj.ol,tmpseed:byA.LK(),lkeClass:this.bkZ.byB(this)},cache:{klass:bp.dZ},onemptylist:this.nL.byB(this),onbeforelistload:this.jG.byB(this),onafteradd:this.qM.byB(this,"",{parent:this.cWQ}),onbeforelistrender:this.qM.byB(this,""),onbeforelistclear:this.tV.byB(this,"playlist_fav"),onafterlistrender:this.hR.byB(this,"playlist_fav")};this.bwK={selected:"z-sel",item:"j-flyg"};this.nG=bp.dZ.bG({onlistload:this.uy.byB(this)});bD.fo("focus","winhelper",this.Xs.byB(this,"focus"));bD.fo("losefocus","winhelper",this.Xs.byB(this,"losefocus"));bi.bM(bp.mx,"message",this.cwg.byB(this));bi.bM(this.cfc,"click",this.cMN.byB(this));this.cnU()};byx.byT=function(blZ){this.cmx(blZ);this.cJF();this.JT();if(!this.Wq){this.Wq=!0;dc.playlist.Wr();this.bKu({})}};byx.dq=function(blZ){this.dC(blZ);this.gP(blZ)};byx.gP=function(blZ){var dp=/\/m\/(disc|friend|offline|local|mv)\//;var gJ=(blZ.input||cJO).location||blZ;var oK=gJ.target.match(dp);if(oK){this.bBH=this.Xn.lg(oK[0]);if(oK[0]=="/m/friend/"){this.bBH=this.Xn.lg("/m/friend/home/");this.bBG=true;byA.bJ(this.Xm,"hastip")}else{this.bBG=false}if(oK[0]=="/m/local/"){this.bBH.firstElementChild.href="#"+gJ.target}}else{this.bBG=false;this.bBH=this.Xn.lg(gJ.target)}var bo=(gJ.param||cJO).id;this.IY=bo;bm.dP(this.pM,function(Bl){Bl.lg(bo)});this.bNJ();this.bZW();if(gJ.target=="/m/fav/djradio/"){byA.bJ(this.cqv,"hastip")}else if(gJ.target=="/m/cloud/"){bj.cL(11,function(cJN){var ml=cJN.fF();ml.cloudTip=true})}var cJE=!1;if(gJ.target=="/m/fm/"){cJE=!!this.cJC!=!0;this.cJC=!0}else{cJE=!!this.cJC!=!1;this.cJC=!1}if(cJE){this.cJF()}var cq=dc.setting.bEd();if(cq.foldlist){this.cXq(this.cXl,this.cWQ,cq.foldlist[0]);this.cXq(this.cXO,this.cXM,cq.foldlist[1])}else{dc.setting.bEo("foldlist",[!1,!1])}};byx.bKu=function(byy){if(!byy)return;this.dn=localCache.cF("host.profile.userId");this.bBJ.cache.lkey="playlist_new-"+this.dn;this.Xr.cache.lkey="playlist_fav-"+this.dn;if(this.qV){this.qV.bQ();delete this.qV}if(this.bwJ){this.bwJ.bQ();delete this.bwJ}this.nG.wp(this.dn,!0);bj.cL(13,function(cJN){cJN.bXC("clear");cJN.cgA()});bj.cL(12,function(cJN){cJN.mD(!0)});this.cnU()};byx.cnU=function(){if(bj.btm()){byA.bK(this.cqm,"f-dn")}else{byA.bJ(this.cqm,"f-dn")}};byx.Xs=function(bq,byy){};byx.bNJ=function(){var di=bj.cL(4,function(cJN){return{download:cJN.hQ("track_offline_download")}});var bLq=Math.max(0,di.download);this.bNH.href=bLq?"#/m/offline/download/":"#/m/offline/complete/"};byx.jG=function(byy){byy.value=byA.gy("m-xwgt-list-loading")};byx.uy=function(blZ){if(!!this.qV)return;this.qV=bU.jN.bG(this.bBJ);this.bwJ=bU.jN.bG(this.Xr)};byx.bkF=function(dJ){return!this.nG.Hf(dJ)};byx.qM=function(zJ,blZ){byA.byW(blZ.parent,"display",zJ);byA.byW(blZ.parent.previousElementSibling,"display",zJ)};byx.By=function(byy){var Xu="z-import-empty",cD=byy.parent.parentNode;var bg=byA.bV(cD,"j-flyg");if(bg.length>1){byA.bJ(cD,Xu)}else{byA.bK(cD,Xu)}};byx.nL=function(byy){this.By(byy);this.qM("none",byy)};byx.tV=function(bq){var Bl=this.pM[bq],Xv=this.Xp[bq],Xw=this.Xq[bq];if(!!Bl){Bl.bQ();delete this.pM[bq]}if(!!Xv){Xv.bQ();delete this.Xp[bq]}if(!!Xw){Xw.bQ();delete this.Xq[bq]}};byx.hR=function(bq,byy){this.By(byy);this.tV(bq);var bg=byA.bV(byy.parent,"j-flyg");if(!!this.pM[bq])this.pM[bq].recycle();this.pM[bq]=bU.mP.bG({selected:"z-sel",list:bg,oncheck:this.bkW.byB(this)});this.pM[bq].lg(this.IY);var bkX=bj.cL(4,function(cJN){return cJN.gB()});this.CC({newValue:bkX,oldValue:null})};byx.bkW=function(byy){if(byy.target==byy.source){localCache.bSX("s-side-left",byy.target);byy.matched=true}};byx.bkw=function(byy){if(byy.id==10019){this.Bn();this.cBC=byy.data}};byx.bky=function(iq){var cD=this.bBJ.parent;var kq=byA.bV(cD,"j-flyg")[1];if(kq){cD.insertBefore(iq,kq)}else{cD.appendChild(iq)}};byx.Bn=function(){if(!localCache.cF("host.profile.userId")){bj.ci({txt:"网络不给力哦，请检查你的网络设置~"});return}byA.bJ(this.cXl,"z-hide");byA.bJ(this.cWQ,"z-fold");this.cWQ.title="收起";var cq=dc.setting.bEd().foldlist;cq[0]=false;dc.setting.bEo("foldlist",cq);delete this.cBC;this.Xo();if(!this.bBs){this.bBs=bj.Xi.bG(this.byJ)}nm.log.dE(nm.log.ACTION.PC_CLICK,null,null,"newplaylist")};byx.bkz=function(byy){this.Xo();var bO=byy.value;if(!bO)return;this.qV.dE({name:bO,uid:this.dn})};byx.Xo=function(){if(!!this.bBs){this.bBs.bQ();delete this.bBs}};byx.bkG=function(byy){var dJ=byy.data,bh=this.cBC;delete this.cBC;if(!dJ||!bh)return;bj.cL(4,function(cJN){cJN.iL({key:"track_playlist-"+dJ.id,data:{trackIds:bh.track,localIds:bh.local,pid:dJ.id}})})};var Tj=function(dQ,cgz){dQ.scrollTop+=(cgz+1)*2.27;cgz--;if(cgz>0)setTimeout(Tj.byB(this,dQ,cgz),20)};byx.cZv=function(byy,bs,cOD){var chj,bg;var cq=dc.setting.bEd().foldlist;if(bs==0){chj=this.cWQ;bg=this.cXl}else{chj=this.cXM;bg=this.cXO}if(byA.ey(bg,"z-hide")){cq[bs]=false;this.cXq(bg,chj,false);if(bs>0){var cr=byA.lp(chj,this.bA);if(cr.y>this.bA.offsetHeight+this.bA.scrollTop-32){if(bg.childElementCount>500||cOD){this.bA.scrollTop+=150}else{Tj(this.bA,10)}}}}else{cq[bs]=true;this.cXq(bg,chj,true)}dc.setting.bEo("foldlist",cq)};byx.cXq=function(bg,chj,cbH){if(cbH){byA.bK(bg,"z-hide");byA.bK(chj,"z-fold");chj.title="展开"}else{byA.bJ(bg,"z-hide");byA.bJ(chj,"z-fold");chj.title="收起"}};byx.bZW=function(){var chq=0,chr=0,chs=0,crW=0,crV=0;if(!bj.btm()){var fz=bj.cL(13,function(cJN){return cJN.chw()});if(!fz.isDef){chq=Math.max(fz.mvCnt||0,0);chr=Math.max(fz.djCnt||0,0);chs=Math.max(fz.arCnt||0,0);crW=Math.max(fz.newRdCnt||0,0);crV=Math.max(fz.favRdCnt||0,0)}}chq>0?byA.bJ(this.chB,"f-dn"):byA.bK(this.chB,"f-dn");crV||crW?byA.bJ(this.chC,"f-dn"):byA.bK(this.chC,"f-dn");!bj.btm()?byA.bJ(this.chA,"f-dn"):byA.bK(this.chA,"f-dn")};byx.Jf=function(byy){if(bj.btm()){byA.bJ(this.Xm,"hastip");return}if(this.bBG)return;if(byy&&byy.event&&byy.friend){var dR=byy.event||byy.friend.count&&byy.friend.friend.snsType;if(dR>0){byA.bK(this.Xm,"hastip")}else{byA.bJ(this.Xm,"hastip")}}};byx.cJF=function(){this.Xt(bj.cL(4,function(cJN){return cJN.gB()}))};byx.Xt=function(dk){if(!dk||dk.state==0||this.cJC&&dk.from.hasOwnProperty("fm")){byA.bJ(this.bA,"m-nav-s")}else{byA.bK(this.bA,"m-nav-s")}};byx.hA=function(oW){switch(oW.data.cmd){case"cardhide":break;case"leftrefresh":this.gP(oW.data.data);break}};byx.bjD=function(byy){byy=byy||cJO;if(byy.online==true){logger.warn("网络状态变化，5s后刷新歌单列表","search/index.js","__onLineStateChange");setTimeout(function(){bj.cL(1,function(cJN){cJN.wp(localCache.cF("host.profile.userId"),!1,!0)})},5e3);logger.warn("网络状态变化，30s后刷新歌单列表","search/index.js","__onLineStateChange");setTimeout(function(){if(!navigator.offline){bj.cL(1,function(cJN){cJN.wp(localCache.cF("host.profile.userId"),!1,!0)});bj.cL(13,function(cJN){cJN.cgA()})}},3e4)}};byx.CC=function(byy){var uw=byy.newValue;if(!uw)return;this.Xt(uw);var ble=byA.cg("my-music-list");var IR=byA.bV(ble,"j-flag");var IP=byA.bV(this.bNI,"j-flyg");if(!IR||!IP)return;var IO="z-pause";var hC=uw.from.href;var bli=function(bk){if(uw.state){var vE=byA.bV(bk,"j-icn")[0];byA.bK(bk,"z-show z-ply");if(uw.state==1){bj.cVV(vE,"icon.sp.svg#list_pause")}else{bj.cVV(vE,"icon.sp.svg#list_play")}}};var Xz=function(bk,bq){var bo=byA.bT(bk,"id");var vE=byA.bV(bk,"j-icn")[0];var bqR=byA.ey(bk,"z-scan");if(bqR)return;byA.bJ(bk,"z-show z-ply");byA.bJ(vE,IO);var blm=bq?hC:uw.from.data;if(blm==bo||bq&&(blm+"").indexOf(bo+"")==0){bli(bk)}};for(var j=0,jF=IR.length;j<jF;j++){Xz(IR[j],true)}for(var i=0,l=IP.length;i<l;i++){Xz(IP[i])}};byx.bbO=function(){var bIT=!1;return function(byy){if(!byy)return;switch(byy.step){case 1:case 2:case 3:if(bIT)break;bIT=!0;byA.bJ(this.cNd,"z-show z-ply");byA.bK(this.cNd,"z-show z-scan");break;case 0:case 4:if(!bIT)break;bIT=!1;byA.bJ(this.cNd,"z-show z-scan");var dk=bj.cL(4,function(cJN){return cJN.gB()});this.CC({newValue:dk,oldValue:null});break}}}();byx.JT=function(){this.bbO(bj.cL(4,function(cJN){return cJN.BU()}))};byx.bkZ=function(){return function(bo){var bTw=bj.bLa();if(bTw==bo){return"lke"}else{return""}}}();byx.cwg=function(bh){if(!bh||bh.code!=200)return;if(!bh.newProgramCount){byA.bJ(this.cqv,"hastip")}else{byA.bK(this.cqv,"hastip")}if(bh.createDJRadioCount==null)return;bj.cL(13,function(cJN){cJN.bXC("updateNewRdCnt",bh.createDJRadioCount)})};byx.cMN=function(){bj.gM("/m/friend/home/",{cmd:"refresh"})};byx.bIb=function(byy){var bu=byy.key;var bg=dc.playlist.byI(bu);if(bg.length==5){var mB=bj.cL(11,function(cJN){return cJN.cDX("playlist_guide")});if(mB){this.bIy(!!bu.match("fav"))}}};byx.bIy=function(bBx){var bg,bxY;if(bBx){bg=this.cXO}else{bg=this.cXl}byA.bK(bg,"z-hide");this.cZv({},bBx,true);this.bxK=ctl.layer.dD({clazz:"z-show",hideNotelay:!0,mask:false,draggable:!1,txt:"m-xwgt-layer-playlistguide-module",zIndex:1,onaction:function(bk){ctl.layer.ddf(this.bxK)}.byB(this)},bR.cXa);bg=byA.bV(bg,"j-flyg");bxY=bg[4]||bg[bg.length-1];this.bA.scrollTop=bxY.offsetTop-this.bA.clientHeight};byx.VV=function(byy){this.bxK&&ctl.layer.ddf(this.bxK)};byx.uf=function(byy){bv=bi.cR(byy,"d:resFrom");if(bv&&byA.bT(bv,"resFrom")==-6){this.bxK&&ctl.layer.ddf(this.bxK)}};bj.cU("/?/frame/side/",bC.Xl)})()</textarea>